<!DOCTYPE html>
<html lang="ru">

  <head>
    <title>Пример HTTP-сервера на PHP с использованием файберов &#x2F; Хабр</title>
<meta property="fb:app_id" content="444736788986613">
<meta property="fb:pages" content="472597926099084">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@habr_com">
<meta property="og:site_name" content="Хабр">
<link href="https://habr.com/ru/rss/post/866254/?fl=ru" type="application/rss+xml" title rel="alternate" name="rss">
<link href="https://habr.com/ru/articles/866254/" rel="canonical" data-hid="e3fa780">
<link rel="image_src" href="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/" data-hid="2a79c45">
<link rel="amphtml" href="https://habr.com/ru/amp/publications/866254/">
<meta property="og:title" content="Пример HTTP-сервера на PHP с использованием файберов">
<meta name="twitter:title" content="Пример HTTP-сервера на PHP с использованием файберов">
<meta name="aiturec:title" content="Пример HTTP-сервера на PHP с использованием файберов">
<meta name="description" content="Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber , который, согласно RFC , должен упростить...">
<meta itemprop="description" content="Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber , который, согласно RFC , должен упростить...">
<meta property="og:description" content="Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber , который, согласно RFC , должен упростить...">
<meta name="twitter:description" content="Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber , который, согласно RFC , должен упростить...">
<meta property="aiturec:description" content="Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber , который, согласно RFC , должен упростить...">
<meta itemprop="image" content="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/">
<meta property="og:image" content="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="aiturec:image" content="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/">
<meta name="twitter:image" content="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/">
<meta property="vk:image" content="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/?format=vk">
<meta property="vk:image" content="https://habr.com/share/publication/866254/b483cf46205a034b2dd6194dc10b5bff/?format=vk?format=vk">
<meta property="aiturec:item_id" content="866254">
<meta property="aiturec:datetime" content="2024-12-13T07:16:19.000Z">
<meta content="https://habr.com/ru/articles/866254/" property="og:url">
<meta property="og:type" content="article">
<meta property="og:locale" content="ru_RU">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="keywords" content="php, fiber, non-blocking">
<script type="application/ld+json" data-hid="1e0f0a2">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/articles\/866254\/"},"headline":"Пример HTTP-сервера на PHP с использованием файберов","datePublished":"2024-12-13T10:16:19+03:00","dateModified":"2024-12-13T10:16:19+03:00","author":{"@type":"Person","name":"Антон"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber, котор...","url":"https:\/\/habr.com\/ru\/articles\/866254\/#post-content-body","about":["h_php","h_parallel_programming","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/866254\/b483cf46205a034b2dd6194dc10b5bff\/"]}</script>
    <meta charset="UTF-8">
    <meta name="viewport"
      content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
    <meta name="referrer" content="unsafe-url">
    <style>
      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5VvmojLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5Vvk4jLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5VvmYjLazX3dGTP.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9E4kDNxMZdWfMOD5Vvl4jLazX3dA.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveSxf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveQhf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveSBf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 500;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnZKveRhf6Xl7Glw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }

      /* cyrillic-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eSxf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }

      /* cyrillic */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eQhf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }

      /* latin-ext */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eSBf6Xl7Gl3LX.woff2) format('woff2');
        unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
      }

      /* latin */
      @font-face {
        font-family: 'Fira Sans';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url(https://fonts.gstatic.com/s/firasans/v17/va9B4kDNxMZdWfMOD5VnLK3eRhf6Xl7Glw.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }
    </style>
    <link rel="preload" href="https://assets.habr.com/habr-web/css/theme/light-v1.css" as="style" media="(prefers-color-scheme: light)" /><link rel="preload" href="https://assets.habr.com/habr-web/css/theme/dark-v1.css" as="style" media="(prefers-color-scheme: dark)" /><link id="light-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/light-v1.css" media="(prefers-color-scheme: light)" /><link id="dark-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/dark-v1.css" media="(prefers-color-scheme: dark)" />
    <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.7df697fae1341e0209866060a0b89415.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
    <style>
      .grecaptcha-badge {
        visibility: hidden;
      }
    </style>
    <meta name="habr-version" content="2.218.0">
    
    <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
    <meta name="msapplication-TileColor" content="#629FBC">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png">
    <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png">
    <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png">
    <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png">
    <link rel="apple-touch-startup-image"
      media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
      href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png">
    <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg">
    <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest">
    <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
    <script>window.yaContextCb = window.yaContextCb || []</script>
    <script src="https://yandex.ru/ads/system/context.js" async></script>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.04465f7c.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.5f7b98a7.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.3175e1d0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.ba2c25ec.js" as="script"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.04465f7c.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.3175e1d0.css"></head>
  <body>
    
    <div id="mount"><div id="app" data-async-called="true"><div class="tm-layout__wrapper"><!--[--><!----><div></div><div class="tm-feature tm-feature"><!----></div><header class="tm-header" data-test-id="header"><div class="tm-page-width"><!--[--><div class="tm-header__container"><div class="tm-header__burger-nav" data-test-id="burger-nav"><button class="tm-header__button tm-header__button_burger" type="button"><svg class="tm-svg-img tm-header__icon tm-header__icon-burger" height="16" width="16"><title>Меню</title><use xlink:href="/img/megazord-v28.7909a852..svg#header-burger"></use></svg></button></div><span class="tm-header__logo-wrap"><a class="tm-header__logo tm-header__logo_hl-ru tm-header__logo_ny tm-header__logo" href="/ru/"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 66 30" class="tm-header__icon"><path fill="#fff" d="M16.3 3.6h-4.2L8.2 9.7 4.4 3.6H0l5.8 9-5.8 9h4.3l3.8-6.3 3.9 6.3h4.3l-5.8-9 5.8-9zm7.4 4.8c-3.4 0-5.3 2-5.7 4.2h3.4c.2-.7.8-1.4 2.1-1.4s2.1.6 2.1 1.8v.6h-2.8c-3.3 0-5.3 1.5-5.3 4.2s2 4.1 4.5 4.1 3-.6 3.8-1.7v1.4h3.4v-8.5c0-3.1-2.2-4.8-5.5-4.8zm2 8.4c0 1.5-1.2 2.3-2.6 2.3s-1.8-.5-1.8-1.4.8-1.5 1.9-1.5h2.5v.6zm13.7-7.9c-1.8 0-3.3.7-4.2 2 .2-2.4 1.2-3.6 3.7-4l4.6-.7V3l-5 .9c-5.1.8-6.7 4.2-6.7 9.9s2.5 8.1 6.8 8.1 6.4-3 6.4-6.6-2.2-6.4-5.6-6.4zm-.9 10c-1.9 0-3-1.5-3-3.6s1.1-3.4 3-3.4 2.8 1.5 2.8 3.4-1 3.5-2.9 3.5zM54.8 8.4c-1.9 0-3.1.8-3.8 1.8V8.6h-3.5v18h3.7v-6.2c.7.9 1.9 1.5 3.5 1.5 3.2 0 5.7-2.5 5.7-6.8s-2.5-6.8-5.6-6.8zm-.9 10.4c-1.7 0-2.8-1.4-2.8-3.6 0-2.3 1.1-3.7 2.8-3.7s2.8 1.4 2.8 3.6-1.1 3.6-2.8 3.6z"></path><path fill="url(#a)" d="M56.7.8c5 0 6.3 3.7 6.3 4.7-3-2-6.5 1.5-6.5 1.5s.2-4.2.2-6.2z"></path><linearGradient id="a" x1="63" x2="56.5" y1="1" y2="1" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#e84256"></stop><stop offset="1" stop-color="#ab1427"></stop></linearGradient><path fill="#b8d5ff" d="M65 6.1c-.3 1.1-1.4 1.7-2.5 1.4-1.1-.3-1.7-1.4-1.4-2.5s1.4-1.7 2.5-1.4c1.1.3 1.7 1.4 1.4 2.5z"></path><path fill="#e84256" d="M55.3 1.1c1.1-.8 2.8-.3 3.3.9l4.1 10.5c.6 1.6-.9 3.1-2.5 2.6l-13.3-3.8c-1.7-.5-2.1-2.6-.7-3.5l9.2-6.7z"></path><path fill="#d1e4ff" d="M62.3 11.6L47 7.2l-.8.6c-1.4 1-.9 3.1.7 3.5l13.3 3.8c1.7.5 3.1-1.1 2.5-2.6l-.4-.9z"></path></svg></a><span style="display:none;" class="tm-header__beta-sign">β</span></span><!----><div class="tm-header-user-menu tm-header_user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search" data-test-id="search-button"><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search" height="24" width="24"><title>Поиск</title><use xlink:href="/img/megazord-v28.7909a852..svg#search"></use></svg></a><!----><!----><div class="tm-header-user-menu__item tm-header-user-menu__write"><div><svg class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_write" height="24" width="24"><title>Написать публикацию</title><use xlink:href="/img/megazord-v28.7909a852..svg#write"></use></svg></div><!----></div><!--[--><div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle" data-test-id="user-menu-settings"><svg class="tm-svg-img tm-header-user-menu__icon" height="24" width="24"><title>Настройки</title><use xlink:href="/img/megazord-v28.7909a852..svg#page-settings"></use></svg></button></div><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/articles/866254/&amp;hl=ru" rel="nofollow" class="tm-header-user-menu__item"><!--[--><button class="btn btn_solid btn_small tm-header-user-menu__login" type="button"><!--[-->Войти<!--]--></button><!--]--></a><!--]--><!----><!--teleport start--><!--teleport end--><!----></div></div><!--]--></div></header><div class="tm-layout"><div class="tm-page-progress-bar"></div><!----><!----><div class="tm-page-width"><!--[--><!--]--></div><main class="tm-layout__container"><div class="tm-page" hl="ru" data-async-called="true"><div class="tm-page-width"><!--[--><!----><div class="tm-page__wrapper"><div class="tm-page__main_has-sidebar tm-page__main"><div class="pull-down"><!----><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg class="tm-svg-img pull-down__icon pull-down__arrow" height="24" width="24"><title>Обновить</title><use xlink:href="/img/megazord-v28.7909a852..svg#pull-arrow"></use></svg></div></div><!--[--><!--[--><div class="banner-wrapper narrow" style="--dbc54a0e:100px;--39219900:300/250;--1735aacc:auto;" data-v-a87e93d9><!--[--><div class="placeholder-wrapper placeholder" style="" data-v-a87e93d9><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="adfox-banner-placeholder narrow" data-v-12f7bcca><div class="image loads" data-v-12f7bcca></div><div class="lines" data-v-12f7bcca><div class="line loads" data-v-12f7bcca></div><div class="line loads" data-v-12f7bcca></div><div class="line loads" data-v-12f7bcca></div></div></div><!----><!----></div><div id="adfox_169815559787254866" class="tm-adfox-banner" data-v-a87e93d9></div><!--]--></div><div class="tm-article-presenter"><!--[--><!--]--><div class="tm-article-presenter__body" data-test-id="article-body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><!--[--><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><!--[--><div class="tm-article-presenter__header"><!--[--><!--]--><div class="tm-article-snippet tm-article-snippet tm-article-presenter__snippet"><!--[--><!--]--><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/cleancodemonkey/" class="tm-user-info__userpic" data-test-id="user-info-pic" title="cleancodemonkey"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" height="32" src="https://assets.habr.com/habr-web/img/avatars/186.png" width="32"><!--]--></div></a><span class="tm-user-info__user tm-user-info__user_appearance-default" data-test-id="user-info-description"><a href="/ru/users/cleancodemonkey/" class="tm-user-info__username">cleancodemonkey <!----></a><!--[--><span class="tm-article-datetime-published"><time datetime="2024-12-13T07:16:19.000Z" title="2024-12-13, 10:16">1 час назад</time></span><!--]--></span></span></div><!----></div><h1 class="tm-title tm-title_h1" lang="ru" data-test-id="articleTitle"><span>Пример HTTP-сервера на PHP с использованием файберов</span></h1><div class="tm-article-snippet__stats" data-test-id="articleStats"><div class="tm-article-complexity tm-article-complexity_complexity-high"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Уровень сложности</title><use xlink:href="/img/megazord-v28.7909a852..svg#complexity-high"></use></svg></span><span class="tm-article-complexity__label">Сложный</span></div><div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Время на прочтение</title><use xlink:href="/img/megazord-v28.7909a852..svg#clock"></use></svg></span><span class="tm-article-reading-time__label">15 мин</span></div><span class="tm-icon-counter tm-data-icons__item"><svg class="tm-svg-img tm-icon-counter__icon" height="24" width="24"><title>Количество просмотров</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-views"></use></svg><span class="tm-icon-counter__value">340</span></span></div><div class="tm-publication-hubs__container" data-test-id="articleHubsList"><div class="tm-publication-hubs"><!--[--><span class="tm-publication-hub__link-container"><a href="/ru/hubs/php/" class="tm-publication-hub__link"><!--[--><span>PHP</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/parallel_programming/" class="tm-publication-hub__link"><!--[--><span>Параллельное программирование</span><span class="tm-article-snippet__profiled-hub" title="Профильный хаб">*</span><!--]--></a></span><!--]--></div></div><div class="tm-article-labels" data-test-id="articleLabels"><div class="tm-article-labels__container"><!----><!--[--><div class="tm-publication-label tm-publication-label_variant-sandbox"><a href="/ru/sandbox/" class="">Из песочницы</a></div><!--]--></div></div><!----><!----></div></div><!--[--><!----><div class="tm-article-body" data-gallery-root lang="ru"><div><!--[--><!--]--></div><div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс <a href="https://www.php.net/manual/ru/class.fiber.php" rel="noopener noreferrer nofollow">Fiber</a>, который, согласно <a href="https://wiki.php.net/rfc/fibers" rel="noopener noreferrer nofollow">RFC</a>, должен упростить создание конкурентных приложений. Однако, материалов, демонстрирующих использование данного функционала для построения приложений практически нет, напротив, говорится, что файберы - это <em>функционал, предназначенный для использования разработчиками фреймворков</em> и приводятся какие-то малоинформативные отрывки кода. В этой статье будет продемонстрирован концептуальный пример конкурентного приложения на PHP с использованием файберов. Приложение представляет собой HTTP-сервер, осуществляющий регистрацию и подсчёт анонимных пользователей с выдачей каждому из них JWT-токена (нужно было добавить какую-то функцию с вводом-выводом, а не просто "Hello-World!"). В качестве хранилища используется сервер Redis. Прототип характеризуется следующими основными свойствами с точки зрения многозадачности:</p><ul><li><p>один HTTP-запрос - один новый файбер, после обработки запроса файбер уничтожается;</p></li><li><p>файберы передают управление друг другу самостоятельно, программист может этим управлять, это <a href="https://en.wikipedia.org/wiki/Cooperative_multitasking" rel="noopener noreferrer nofollow">кооперативная многозадачность</a>;</p></li><li><p>ввод-вывод неблокирующий;</p></li><li><p>системный поток выполнения только один, системные инструменты обеспечения конкурентности (процессы, потоки) внутри приложения не используются, за счёт отсутствия переключений контекста между большим количеством процессов или потоков должна быть обеспечена высокая производительность;</p></li><li><p>для эффективной работы на многоядерном или многопроцессорном окружении стоит запустить несколько инстансов данного приложения за балансировщиком;</p></li><li><p>фреймворки ReactPHP/Swoole/AMPHP/Workerman а также libevent и аналоги не используются намеренно, в первой части статьи поставлена задача обойтись без данных инструментов;</p></li></ul><h3>Разбор кода прототипа</h3><p>Полный код прототипа можно получить из <a href="https://gitflic.ru/project/cleancodemonkey/fabio" rel="noopener noreferrer nofollow">репозитория</a>, в нём предусмотрено окружение на базе Docker Compose.</p><p>Основа, на которой построен данный прототип - <a href="https://www.php.net/manual/ru/book.sockets.php" rel="noopener noreferrer nofollow">сокеты</a> и <a href="https://www.php.net/manual/ru/language.fibers.php" rel="noopener noreferrer nofollow">файберы</a>. Сокеты обеспечивают возможность неблокирующего ввода-вывода, файберы обеспечивают конкурентность. Фактически в прототипе реализована кооперативная (не вытесняющая) многозадачность. <a href="https://www.php.net/manual/ru/book.stream.php" rel="noopener noreferrer nofollow">Потоки PHP</a>  было решено не использовать по причине несовершенства их API, которое не позволяет получить код состояния операции ввода-вывода. К тому же, API сокетов очень схож с системными сетевыми функциями Linux, интерфейс которых проверен временем и есть отличные man-страницы.</p><p>Входная точка в программу - файл <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=bin%2Fserver.php&amp;branch=master" rel="noopener noreferrer nofollow">bin/server.php</a>, Она выполняет подключение автолоадера, загрузку переменных окружения из файла <code>.env,</code> запуск сервера. Главный цикл сервера, управляющий запуском файберов находится в файле <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FApp.php&amp;branch=master" rel="noopener noreferrer nofollow">src/App.php</a>:</p><pre><code class="php">private function __construct(FiberedHandlerFactory $factory)
{
    $this-&gt;handlerCollection = new FiberedHandlerCollection();
    $this-&gt;factory = $factory;
    pcntl_async_signals(true);
    pcntl_signal(SIGINT, [$this, 'interrupt']);
    $serverSocket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
    if ($serverSocket === false) {
        exit('Error creating server socket.');
    }
    if (!socket_set_nonblock($serverSocket)) {
        exit('Error switching socket to the nonblocking mode.');
    }
    if (!socket_bind($serverSocket, getenv('HTTP_BIND_HOST'), (int)getenv('HTTP_BIND_PORT'))) {
        exit('Error binding socket.');
    }
    if (!socket_listen($serverSocket, SOMAXCONN)) {
        exit('Error switching socket to the listening mode.');
    }
    $this-&gt;handlerCollection-&gt;push($this-&gt;factory-&gt;createServerHandler($serverSocket, $this-&gt;handlerCollection));
}

public function interrupt(): void
{
    $this-&gt;interrupted = true;
}</code></pre><p>В качестве аргумента конструктор принимает фабрику обработчиков <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FFiberedHandlerFactory.php&amp;branch=master" rel="noopener noreferrer nofollow">src/FiberedHandlerFactory.php</a>, которые построены на базе файберов. Их работа будет описана далее. Также в первых строках создаётся коллекция обработчиков <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FFiberedHandlerCollection.php&amp;branch=master" rel="noopener noreferrer nofollow">src/FiberedHandlerCollection.php</a> , фактически представляющая собой очередь из обработчиков для выполнения. Вызовы функций <code>pcntl_async_signals()</code> и <code>pcntl_signal()</code> необходимы для установки обработчика системного сигнала <code>SIGINT</code>, чтобы операционная система имела возможность корректно остановить данный сервер. Далее создаётся основной сокет сервера, который сразу переводится в неблокирующий режим и передаётся отдельному обработчику входящий соединений, работающему на базе файбера. </p><p>Далее предлагаю взглянуть на код главного цикла сервера в файле <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FApp.php&amp;branch=master" rel="noopener noreferrer nofollow">src/App.php</a>:</p><pre><code class="php">public function run(): void
{
    App::debug("HTTP server has been started. Waiting for connections...");
    while (true) {
        $readSockets = $this-&gt;handlerCollection-&gt;getReadSockets();
        $writeSockets = $this-&gt;handlerCollection-&gt;getWriteSockets();
        $exceptSockets = $this-&gt;handlerCollection-&gt;getExceptSockets();
        //блокируемся на всех известных сокетах, чтобы процессор не крутил цикл
        if(false === socket_select(
                $readSockets,
                $writeSockets,
                $exceptSockets,
                null
            )) {
            exit(sprintf('Fatal error: socket_select() call failed: %s', socket_strerror(socket_last_error())));
        }
        if ($this-&gt;interrupted) {
            //получили сигнал завершения работы
            break;
        }
        $fiberedHandlers = $this-&gt;handlerCollection-&gt;getHandlers($readSockets, $writeSockets, $exceptSockets);
        App::debug("Count of fibers: %d", $this-&gt;handlerCollection-&gt;getCount());
        foreach ($fiberedHandlers as $fiberedHandler) {
            $fiberedHandler-&gt;resetSockets();
            if ($fiberedHandler-&gt;isSuspended()) {
                $fiberedHandler-&gt;resume();
            }
            if (!$fiberedHandler-&gt;isStarted()) {
                $fiberedHandler-&gt;start();
            }
            if ($fiberedHandler-&gt;isTerminated()) {
                $this-&gt;handlerCollection-&gt;remove($fiberedHandler);
            }
        }
    }
}</code></pre><p>Центральное место в цикле занимает вызов <code>socket_select()</code>, который позволяет понять, какие из сокетов в приложении готовы к вводу-выводу. В первых строках цикла можно видеть сбор массивов всех сокетов, обработки которых нужно подождать. После вызова <code>socket_select()</code> в массивах останутся только те сокеты, которые готовы к вводу-выводу. Основной сокет сервера также передаётся в вызов <code>socket_select()</code>, если он останется в массиве <code>$readSockets</code> после вызова, это означает, что появилось новое подключение к серверу. Обработчик новых подключений выделен в самостоятельный файберный обработчик, который работает с обработчиками генерации ответов на HTTP-запросы в конкурентном режиме. Это сделано намеренно, чтобы сервер равномерно принимал новые подключения и выдавал ответы на уже принятые. Важный код обработчика новых соединений <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FNewConnectionsHandler.php&amp;branch=master" rel="noopener noreferrer nofollow">src/NewConnectionsHandler.php</a>:</p><pre><code class="php">private function run(): void
{
    while (true) {
        //ограничение из-за FD_SETSIZE для типа fd_set в системном вызове select()
        if ($this-&gt;handlerCollection-&gt;getCount() &gt; self::MAX_FIBERS) {
            Fiber::suspend();

            continue;
        }
        $acceptedSocket = socket_accept($this-&gt;serverSocket);
        if ($acceptedSocket === false) {
            Fiber::suspend();

            continue;
        }
        if (!socket_set_nonblock($acceptedSocket)) {
            App::error("Error switching socket to the nonblocking mode.");
            socket_close($acceptedSocket);

            continue;
        }
        $this-&gt;handlerCollection-&gt;push($this-&gt;factory-&gt;createRequestHandler($acceptedSocket));
        Fiber::suspend();
    }
}</code></pre><p>Здесь есть свой бесконечный цикл, управление из которого периодически передаётся основному циклу сервера с помощью вызова <code>Fiber::suspend()</code>. Сокет, появившийся после вызова <code>socket_accept()</code>(получение нового подключения к серверу), также сразу переводится в неблокирующий режим. Для обслуживания принятого сокета с помощью упомянутой фабрики обработчиков <code>FiberedHandlerFactory</code> создаётся обработчик принятого соединения, в обязанности которого входит получение и разбор данных HTTP-запроса, вызов шаблонного метода генерации ответа, а также отправка ответа по принятому соединению. </p><p>Вернёмся к основному циклу в файле <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FApp.php&amp;branch=master" rel="noopener noreferrer nofollow">src/App.php</a>. После <code>socket_select()</code> приложение вызывает метод<code>FiberedRequestHandlerCollection::getHandlersBySockets()</code>, передав в качестве аргумента массив готовых к работе сокетов. Коллекция на основе соответствия сокетов и обработчиков, а также собственных правил выдаёт в качестве ответа на данный вызов массив обработчиков, которые затем будут выполнены:</p><pre><code class="php">$fiberedHandlers = $this-&gt;handlerCollection-&gt;getHandlers($readSockets, $writeSockets, $exceptSockets);
App::debug("Count of fibers: %d", $this-&gt;handlerCollection-&gt;getCount());
foreach ($fiberedHandlers as $fiberedHandler) {
    $fiberedHandler-&gt;resetSockets();
    if ($fiberedHandler-&gt;isSuspended()) {
        $fiberedHandler-&gt;resume();
    }
    if (!$fiberedHandler-&gt;isStarted()) {
        $fiberedHandler-&gt;start();
    }
    if ($fiberedHandler-&gt;isTerminated()) {
        $this-&gt;handlerCollection-&gt;remove($fiberedHandler);
    }
}</code></pre><p>Методы <code>FiberedRequestHandler::isSuspended()</code>, <code>FiberedRequestHandler::resume()</code>, <code>FiberedRequestHandler::isStarted()</code>, <code>FiberedRequestHandler::start()</code>, <code>FiberedRequestHandler::isTerminated()</code>, как можно догадаться, являются прокси над одноимёнными методами класса <code>Fiber</code>. Логика, реализованная в цикле, довольно проста: если обработка файбера была приостановлена - продолжаем, если ещё не начиналась - начинаем,  если она завершилась - нужно удалить данный файберный обработчик из коллекции.</p><h3>Базовый файберный обработчик HTTP-запросов</h3><p>Теперь пора поговорить о классе файберного обработчика запросов <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FHttpRequestHandler.php&amp;branch=master" rel="noopener noreferrer nofollow">src/HttpRequestHandler.php</a>. Его функция заключается в получении из сокета и разборе HTTP-запроса, вызове шаблонного метода по генерации ответа на запрос,  сериализации и записи ответа на запрос в сокет. Всё это делается внутри функции, которая передаётся в конструктор файбера:</p><pre><code class="php">public function __construct(int $id, Socket $acceptedSocket)
{
    $this-&gt;id = $id;
    $this-&gt;acceptedSocket = $acceptedSocket;
    $this-&gt;fiber = new Fiber([$this, 'run']);
    $this-&gt;addReadSocket($acceptedSocket);
}

public function __destruct()
{
    $this-&gt;closeResources();
}</code></pre><p>Метод <code>run()</code>, передаваемый в конструктор файбера в качестве единственного аргумента - коллбэка:</p><pre><code class="php">private function run(): void
{
    try {
        $requestHeaders = $this-&gt;readRequestHeaders();
        $stream = $this-&gt;readRequestStream($requestHeaders);
        $this-&gt;handleHttpRequestInternal($stream);
    } catch (HttpRequestException $e) {
        $code = $e-&gt;getCode();
        if (!in_array($code, [400, 500])) {
            $code = 500;
        }
        $this-&gt;sendHttpResponse(new TextResponse($e-&gt;getMessage(), $code));
    } finally {
        $this-&gt;closeResources();
    }
}</code></pre><p>Отдельно стоит отметить чтение HTTP-запроса и его запись. Чтение из сокета производится неблокирующим способом, сначала читаются и проверяются HTTP-заголовки, затем тело. Когда нужно подождать готовности сокета, управление с помощью вызова <code>Fiber::suspend()</code> отдаётся обратно основному циклу сервера. который может во время ожидания ввода-вывода вызвать другой файберный обработчик из сформированного массива на выполнение или просмотреть список сокетов на предмет к готовности к работе. В этом и заключается основной принцип на котором построена конкурентность в данном приложении - отдать управление, когда оно не нужно и делать что-то полезное, пока ядро системы занимается вводом-выводом и готовит сокет. Если ни один из сокетов не готов (в том числе принимающий новые соединения), то приложение заблокируется на вызове <code>socket_select()</code> и ничего не будет делать. Данный подход очень похож на реализованный в ReactPHP/Swoole/AMPHP паттерн Реактор, но без применения событийных расширений для PHP. Возможно, в следующих статьях стоит реализовать данную незамысловатую функциональность с помощью перечисленных фреймворков и выполнить сравнение их производительности с данным решением. Код чтения HTTP-заголовков:</p><pre><code class="php">private function readRequestHeaders(): string
{
    $requestHeaders = '';
    $start = time();
    $byteCounter = 0;
    while (true) {
        $headerLine = socket_read($this-&gt;acceptedSocket, 1);
        if ($headerLine === false) {
            $errorCode = socket_last_error($this-&gt;acceptedSocket);
            socket_clear_error($this-&gt;acceptedSocket);
            if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK])) {
                $this-&gt;addReadSocket($this-&gt;acceptedSocket);
                Fiber::suspend();
                if ($this-&gt;isTimeoutReached($start)) {
                    App::debugFiber($this, 'Connection timed out while reading request headers. Socket error code: %d. Data: %s', $errorCode, json_encode($requestHeaders));
                    throw new HttpRequestException('Connection timed out while reading request headers.');
                }

                continue;
            }
            if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {
                throw new HttpRequestException(sprintf("Error reading data: %s", socket_strerror($errorCode)));
            }
        }
        $byteCounter++;
        if ($byteCounter &gt; self::MAX_HTTP_HEADERS_SIZE) {
            throw new HttpRequestException('HTTP Request headers are too large.');
        }
        $requestHeaders .= $headerLine;
        if (str_ends_with($requestHeaders, "\r\n\r\n")
            || str_ends_with($requestHeaders, "\r\r")
            || str_ends_with($requestHeaders, "\n\n")
            || strlen($headerLine) === 0) {
            return $requestHeaders;
        }
    }
}</code></pre><p>Для облегчения логики разбора запросов используется реализация стандарта PSR-7 и PSR-17 из пакета <code>Laminas/Diactoros</code>, высококачественный код которого отказался очень удобным для решения данной задачи. Реализация поддерживает только те функции протокола HTTP, которые необходимы для построение совсем простого API (GET/POST методы, <code>application/json</code> в теле ограниченного размера).</p><p>Метод <code>FiberedRequestHandler::handleHttpRequestInternal()</code> выполняет вызов шаблонного метода (паттерн Template Method) <code>FiberedRequestHandler::handleHttpRequest()</code> и отправку ответа в сокет, а также обработку ошибок. Приведём здесь только код отправки ответа в сокет:</p><pre><code class="php">private function sendHttpResponse(ResponseInterface $response): void
{
    $responseString = ResponseSerializer::toString($response);
    $written = 0;
    $start = time();
    while ($written &lt; strlen($responseString)) {
        $buffer = substr($responseString, $written);
        $result = socket_write($this-&gt;acceptedSocket, $buffer);
        if ($result === false) {
            $errorCode = socket_last_error($this-&gt;acceptedSocket);
            socket_clear_error($this-&gt;acceptedSocket);
            if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK])) {
                $this-&gt;addWriteSocket($this-&gt;acceptedSocket);
                Fiber::suspend();
                if ($this-&gt;isTimeoutReached($start)) {
                    App::errorFiber($this,'Connection timed out while sending HTTP response. Socket error code: %d. Bytes written: %d.', $errorCode, $written);

                    return;
                }

                continue;
            }
            if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {
                App::errorFiber($this, "Socket error: %s", socket_strerror($errorCode));

                break;
            }
        } else {
            $written += $result;
        }
    }

    App::debugFiber($this, "Response has been sent.");
}</code></pre><p>Код неблокирующей записи в сокет напоминает код чтения. Когда нужно подождать, управление с помощью файбера отдаётся основному циклу программы для выполнения какой-нибудь другой полезной работы вместо ожидания завершения ввода/вывода.</p><p>Шаблонный метод генерации ответа на HTTP-запрос имеет простую реализацию и предназначен для переопределения в дочерних классах:</p><pre><code class="php">/** @throws Throwable */
protected function handleHttpRequest(RequestInterface $request): ResponseInterface
{
    return new TextResponse("Hello from fibered php http server!\n");
}</code></pre><h3>Обработчик запроса на регистрацию анонимного пользователя и возврат JWT</h3><p>Класс <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=src%2FJWTRequestHandler.php&amp;branch=master" rel="noopener noreferrer nofollow">src/JWTRequestHandler.php</a>, наследующий базовый обработчик <code>HttpRequestHandler</code>, реализует логику генерации UUID для анонимного пользователя, сохраняет его вместе с датой регистрации в Redis и генерирует JWT-токен, который возвращается в виде ответа на HTTP-запрос. Помимо этого обработчик ведёт подсчёт количества пользователей. Интерес здесь представляет код ввода-вывода данных в Redis. Как можно догадаться, блокирующий драйвер <code>Predis</code> здесь не подойдёт, но, к счастью, Redis имеет простой текстовый протокол реализованный в библиотеке clue/redis-protocol, который отлично работает через неблокирующий TCP-сокет:</p><pre><code class="php">private function connectToRedisUsingSocket(): void
{
    $redisSocket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
    if ($redisSocket === false) {

        return;
    }
    if (!socket_set_nonblock($redisSocket)) {

        return;
    }
    $start = time();
    while (true) {
        $connected = socket_connect($redisSocket, getenv('REDIS_HOST'), (int)getenv('REDIS_PORT'));
        if (!$connected) {
            $errorCode = socket_last_error($redisSocket);
            socket_clear_error($redisSocket);
            if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK, SOCKET_EALREADY])) {
                $this-&gt;addWriteSocket($redisSocket);
                Fiber::suspend(); //передача управления, чтобы программа занималась полезной работой, а не ждала подключения
                if ($this-&gt;isTimeoutReached($start)) {
                    App::debugFiber($this, 'Connection timed out while connecting to Redis. Socket error code: %d.', $errorCode);
                    throw new RuntimeException('Connection timed out while connecting to Redis.');
                }

                continue;
            }
            if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {
                throw new RuntimeException(sprintf("Socket error: %s", socket_strerror($errorCode)));
            }
        }
        break;
    }
    $this-&gt;redisSocket = $redisSocket;
}</code></pre><p>Как и в случае с обработкой HTTP-соединений, используется неблокирующий ввод-вывод. Если возникает операция ввода-вывода, результата которой нужно подождать, эта операция должна быть выполнена в неблокирующем режиме в цикле, с передачей управления основному циклу если ввод-вывод ещё не завершился. Инкремент счётчика пользователей и сохранение данных пользователя в Redis реализованы именно таким способом:</p><pre><code class="php">$requestMessage = $this-&gt;serializer-&gt;getRequestMessage('INCR', ['user_counter']);
$written = 0;
$start = time();
while ($written &lt; strlen($requestMessage)) {
    $buffer = substr($requestMessage, $written);
    App::debugFiber($this,'Trying to write %s to the socket.', json_encode($buffer));
    $result = socket_write($redisSocket, $buffer);
    if ($result === false) {
        $errorCode = socket_last_error($redisSocket);
        socket_clear_error($redisSocket);
        if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK])) {
            $this-&gt;addWriteSocket($redisSocket);
            Fiber::suspend();
            if ($this-&gt;isTimeoutReached($start)) {
                App::debugFiber($this, 'Connection timed out while incrementing counter. Socket error code: %d. Bytes written: %d.', $errorCode, $written);
                throw new RuntimeException('Connection timed out while incrementing counter.');
            }

            continue;
        }
        if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {
            throw new RuntimeException(sprintf("Socket error: %s", socket_strerror($errorCode)));
        }
    } else {
        $written += $result;
    }
}</code></pre><p>Стоит отметить, что очень немногие драйверы хранилищ поддерживают такие простые текстовые протоколы взаимодействия. В возможных следующих статьях стоит постараться реализовать взаимодействие с другими хранилищами (может для этого и потребуется как-то доработать их драйверы). Тем не менее, сокеты PHP это уже немало, ведь они фактически представляют собой системные вызовы Linux для работы с сетью, которые используются в качестве транспорта в большинстве драйверов хранилищ.</p><h3>Сравнение с реализацией на базе PHP-FPM</h3><p>В качестве кандидата на сравнение решено было использовать реализацию на базе PHP-FPM, которая, учитывая встроенные в PHP-возможности по разбору HTTP-запросов и отправке ответов, а также серверный цикл PHP-FPM, получилась очень простой, в виде одного файла <a href="https://gitflic.ru/project/cleancodemonkey/fabio/blob?file=webroot%2Findex.php&amp;branch=master" rel="noopener noreferrer nofollow">webroot/index.php</a>:</p><pre><code class="php">require __DIR__ . '/../vendor/autoload.php';

$dotenv = Dotenv\Dotenv::createImmutable(dirname(__DIR__));
$dotenv-&gt;load();

header('Content-Type', 'application/json');

$predis = new Client([
    'scheme' =&gt; 'tcp',
    'host'   =&gt; getenv('REDIS_HOST'),
    'port'   =&gt; getenv('REDIS_PORT'),
]);

$counter = $predis-&gt;incr('user_counter');

if ($counter === false) {
    header('HTTP/1.1 500 Internal Server Error');
    echo 'Error while incrementing user counter.';

    return;
}

$user = new User(
    Uuid::uuid4(),
    new DateTimeImmutable(),
    $counter
);

if (!$predis-&gt;set($user-&gt;getId()-&gt;getHex()-&gt;toString(), json_encode($user, JSON_THROW_ON_ERROR))) {
    header('HTTP/1.1 500 Internal Server Error');
    echo 'Error while saving user to Redis.';

    return;
}

$jwtKey = InMemory::plainText(trim(getenv('JWT_KEY')));
$tokenBuilder = new Builder(
    new JoseEncoder(),
    ChainedFormatter::default()
);
$now = $user-&gt;getDate();
$jwt = $tokenBuilder-&gt;issuedAt($now)
    -&gt;expiresAt($now-&gt;modify('+1 hour'))
    -&gt;withHeader('user_id', $user-&gt;getId())
    -&gt;withHeader('counter', $user-&gt;getCounter())
    -&gt;getToken(new Sha256(), $jwtKey);

echo json_encode([
    'jwt' =&gt; $jwt-&gt;toString()
]);</code></pre><p>В конфигурацию Docker Compose были добавлены контейнеры Nginx и PHP-FPM, после запуска данный обработчик будет принимать соединения в порт <code>8086</code>. Файберная реализация доступна в порту <code>8085</code>. Для выполнения нагрузочного тестирования использовалась простая консольная <a href="https://httpd.apache.org/docs/current/programs/ab.html" rel="noopener noreferrer nofollow">утилита Apache Benchmark</a>. Далее приводятся отрывки из результатов запуска нагрузочных тестов. Для каждой реализации было выполнено по 10000 запросов в 1000 потоков. Для оценки производительности используется общее время обработки (чем меньше - тем лучше) и количество обрабатываемых запросов в секунду (чем больше - тем лучше). Бенчмарки выполнялись в окружении, развёрнутом при помощи Docker Compose на ноутбуке автора статьи. Для более объективного сравнения количество ядер процессора, используемых контейнерами файберной реализации и PHP-FPM было ограничено 1 ядром.</p><h3>Результаты бенчмарка реализации на базе Файберов</h3><pre><code class="bash">$ ab -c 1000 -n 10000 http://localhost:8085/
Server Software:
Server Hostname:        localhost
Server Port:            8085

Document Path:          /
Document Length:        244 bytes

Concurrency Level:      1000
Time taken for tests:   54.569 seconds
Complete requests:      10000
Failed requests:        1020
   (Connect: 0, Receive: 0, Length: 1020, Exceptions: 0)
Total transferred:      2946584 bytes
HTML transferred:       2436584 bytes
Requests per second:    183.25 [#/sec] (mean)
Time per request:       5456.885 [ms] (mean)
Time per request:       5.457 [ms] (mean, across all concurrent requests)
Transfer rate:          52.73 [Kbytes/sec] received</code></pre><p>Общее время ~ 55 сек., ~ 183 запроса в секунду.</p><h3>Результаты бенчмарка реализации на базе PHP-FPM</h3><pre><code class="bash">$ ab -c 1000 -n 10000 http://localhost:8086/
Server Software:        nginx/1.27.2
Server Hostname:        localhost
Server Port:            8086

Document Path:          /
Document Length:        244 bytes

Concurrency Level:      1000
Time taken for tests:   94.832 seconds
Complete requests:      10000
Failed requests:        1011
   (Connect: 0, Receive: 0, Length: 1011, Exceptions: 0)
Total transferred:      3666659 bytes
HTML transferred:       2436659 bytes
Requests per second:    105.45 [#/sec] (mean)
Time per request:       9483.242 [ms] (mean)
Time per request:       9.483 [ms] (mean, across all concurrent requests)
Transfer rate:          37.76 [Kbytes/sec] received</code></pre><p>Общее время ~ 94 сек., ~ 106 запросов в секунду.</p><p>Если вы заметили ошибку в реализации или процессе оценки, которая могла привести к значительным огрехам в результирующих данных - прошу написать об этом в комментариях к статье или сообщить автору с помощью личных сообщений.</p><h3>Итоги</h3><p>Как можно видеть из результатов бенчмарков, производительность примера, использующего файберы, оказалась выше реализации на базе PHP-FPM. Безусловно, последняя показала бы себя более эффективно, будучи запущенной на нескольких ядрах, однако реализацию на базе файберов также можно запустить в виде нескольких экземпляров (лучше всего в количестве, равном числу доступных ядер) за балансировщиком, что обеспечит ещё большую производительность на многоядерной или многопроцессорной архитектуре. Также непроанализированным осталось потребление ресурсов. Возможно, его анализ будет приведен в следующих статьях.</p><p>Представленный в статье подход пока трудно рекомендовать к использованию в production. Сокеты и <code>pctnl</code> включены во многих сборках PHP, однако, константа <code>FD_SETSIZE</code> ограничивает количество одновременно обслуживаемых одним вызовом <code>socket_select()</code> сокетов. При нагрузочном тестировании в три процесса, каждый из которых создавал по 1000 соединений одновременно, не было обнаружено каких-либо проблем, т.к. сокеты быстро обслуживаются и закрываются, ведь это HTTP-сервер, где не нужны постоянные соединения. Кроме того, применение ограничивается малым количеством драйверов хранилищ, поддерживающих неблокирующий ввод-вывод (другие неблокирующие драйверы будут продемонстрированы в следующих статьях). Также стоит отметить низкую популярность неблокирующего ввода-вывода и кооперативной многозадачности среди PHP-разработчиков, по субъективным ощущениям, все ждут какого-то аналога потоков (Thread) и пула потоков (ThreadPool) из Python или Runnable из Java Concurrency. Стоит отметить, что файберы работают в одном потоке, а такие приложения гораздо легче отлаживать, чем многопоточные, отсутствует состояние гонки. Остаётся надеяться, что появление файберов и всё возрастающие требования к времени отклика и устойчивости серверных приложений к нагрузкам в совокупности с требованиями к снижению затрат на непомерно дорожающую инфраструктуру будут способствовать повышению популярности более эффективного конкурентного программирования в PHP-сообществе. В следующей статье будет продемонстрировано развитие данного примера, в котором вызов <code>socket_select()</code> будет заменён на более масштабируемое решение, которое позволит обслуживать гораздо большее количество соединений.</p><h3>Ссылка на репозиторий</h3><p><a href="https://gitflic.ru/project/cleancodemonkey/fabio" rel="noopener noreferrer nofollow">cleancodemonkey/fabio</a>  </p><h3>Материалы, использованные при подготовке данной статьи</h3><ul><li><p><a href="http://www.kegel.com/c10k.html" rel="noopener noreferrer nofollow">The C10K problem</a>  </p></li><li><p><a href="https://wiki.php.net/rfc/fibers" rel="noopener noreferrer nofollow">PHP: rfc:fibers</a>  </p></li><li><p><a href="https://habr.com/ru/companies/piter/articles/839526/" rel="noopener noreferrer nofollow">Книга: «Грокаем конкурентность» / Хабр</a>  </p></li><li><p><a href="https://www.youtube.com/watch?v=Q2H-7S1tySM" rel="noopener noreferrer nofollow">Кооперативная многозадачность</a>  </p></li></ul><p></p></div></div></div><!----><!----></div><!----><!----></div><!--]--><!----><div class="tm-article-presenter__meta" data-test-id="article-meta-links"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[php]" class="tm-tags-list__link"><span>php</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[fiber]" class="tm-tags-list__link"><span>fiber</span></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=[non-blocking]" class="tm-tags-list__link"><span>non-blocking</span></a><!--]--></li><!--]--><!----></ul></div><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span><ul class="tm-separated-list__list"><!--[--><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/php/" class="tm-hubs-list__link"><!--[--><span>PHP</span><!--]--></a><!--]--></li><li class="tm-separated-list__item"><!--[--><a href="/ru/hubs/parallel_programming/" class="tm-hubs-list__link"><!--[--><span>Параллельное программирование</span><!--]--></a><!--]--></li><!--]--><!----></ul></div></div><!----><!--]--></article><!--]--></div><!----></div><div style="" class="tm-article-sticky-panel" data-test-id="article-sticky-panel" data-async-called="true"><!--[--><div class="tm-data-icons tm-data-icons tm-data-icons_space-big tm-article-sticky-panel__icons" data-test-id="article-stats-icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-article tm-article-rating__votes-switcher" title="Всего голосов 8: ↑8 и ↓0"><button class="tm-votes-lever__button" data-test-id="votes-lever-upvote-button" title="Нравится" type="button"><svg class="tm-svg-img tm-votes-lever__icon" height="24" width="24"><title>Нравится</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-vote"></use></svg></button><div class="tm-votes-lever__score tm-votes-lever__score_appearance-article tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_positive tm-votes-lever__score-counter" data-test-id="votes-score-counter">+11</span></span><!--]--></div><button class="tm-votes-lever__button" data-test-id="votes-lever-downvote-button" title="Не нравится" type="button"><svg class="tm-svg-img tm-votes-lever__icon tm-votes-lever__icon_arrow-down" height="24" width="24"><title>Не нравится</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-vote"></use></svg></button></div><!--teleport start--><!--teleport end--><!----></div><!----><!----><button class="bookmarks-button tm-data-icons__item" title="Добавить в закладки" type="button"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Добавить в закладки</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-favorite"></use></svg></span><span class="bookmarks-button__counter" title="Количество пользователей, добавивших публикацию в закладки">8</span></button><div class="tm-sharing tm-data-icons__item" title="Поделиться"><button class="tm-sharing__button" type="button"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button><!--teleport start--><!--teleport end--></div><div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="/ru/articles/866254/comments/" class="tm-article-comments-counter-link__link" data-test-id="counter-comments"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value">1</span><!--]--></a><!----></div><!--[--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><!----><!--teleport start--><!--teleport end--><!----></div><div class="reactions-panel-wrapper"><!--[--><div class="reactions-panel" data-v-1d6397d0><div class="reactions" data-v-1d6397d0><!--[--><!--]--><!----></div><!----><div class="add" data-v-1d6397d0><button class="add-reaction-button" data-v-1d6397d0 data-v-8ae43288><div class="add-icon-wrapper" title="Реакции" data-v-8ae43288><svg xmlns="&lt;http://www.w3.org/2000/svg&gt;" viewbox="0 0 24 24" class="add-reaction-icon" data-v-8ae43288><path fill="currentColor" d="M20 1h-2v3h-3v2h3v3h2V6h3V4h-3V1zm-8 2c.338 0 .672.019 1 .055V5.07A7 7 0 1018.93 11h2.015A9 9 0 1112 3zm-2.5 8a1.5 1.5 0 100-3 1.5 1.5 0 000 3zM16 9.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM12 17c-2.05 0-4-1-4-3h8c0 2-1.95 3-4 3z"></path></svg></div></button></div><!----><!----></div><!--]--></div><!--]--></div></div><!--[--><!--]--><div class="tm-article-presenter__footer"><!--[--><!--[--><div class="tm-article-blocks"><!----><!--[--><section class="tm-block tm-block tm-block_spacing-bottom"><!----><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><!--[--><div class="tm-article-author" data-test-id="article-author-info"><!--[--><!--]--><div class="tm-user-card tm-user-card tm-user-card_variant-article tm-article-author__user-card" data-async-called="true"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/cleancodemonkey/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><!--[--><img alt="" class="tm-entity-image__pic" src="https://assets.habr.com/habr-web/img/avatars/186.png"><!--]--></div></a><div class="tm-user-card__meta"><div class="tm-counter-container tm-karma tm-karma" title=" 5 голосов "><div class="tm-counter-container__header"><!--[--><div class="karma-display positive" data-v-7635202e>5</div><!----><!--]--></div><div class="tm-counter-container__footer"><!--[--><div class="tm-karma__text">Карма</div><!--teleport start--><!--teleport end--><!--]--></div></div><div class="tm-counter-container" title="Рейтинг пользователя"><div class="tm-counter-container__header"><!--[--><!--[--><!--]--><div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----><div class="tm-votes-lever__score tm-votes-lever__score_appearance-rating tm-votes-lever__score"><!--[--><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter_rating tm-votes-lever__score-counter" data-test-id="votes-score-counter">11</span></span><!--]--></div><!----></div><!--]--></div><div class="tm-counter-container__footer"><!--[--><span class="tm-rating__text tm-rating__text">Рейтинг</span><!--]--></div></div></div></div></div><div class="tm-user-card__info tm-user-card__info_variant-article tm-user-card__info"><div class="tm-user-card__title tm-user-card__title_variant-article tm-user-card__title"><span class="tm-user-card__name tm-user-card__name_variant-article tm-user-card__name">Антон</span><a href="/ru/users/cleancodemonkey/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article"> @cleancodemonkey</a><!----></div><p class="tm-user-card__short-info tm-user-card__short-info_variant-article tm-user-card__short-info" data-test-id="user-card-speciality">Backend Developer (PHP)</p></div></div><div class="tm-user-card__buttons tm-user-card__buttons_variant-article tm-user-card__buttons"><!----><div class="tm-user-card__button"><div class="tm-button-follow tm-user-card__button-follow"><!----><button class="tm-button-follow__button tm-button-follow__button_big" data-test-id="follow-button" type="button">Подписаться</button></div></div><!----><div class="tm-user-card__button tm-user-card__button_write" data-test-id="user-card-conversations"><svg class="tm-svg-img tm-user-card__button-icon" height="16" width="16"><title>Отправить сообщение</title><use xlink:href="/img/megazord-v28.7909a852..svg#mail"></use></svg></div><!----></div><!----></div><!----></div><!--]--></div><!--]--><!----></section><!----><!--[--><div class="banner-wrapper leaderboard tm-page-article__banner" style="--dbc54a0e:200px;--39219900:300/250;--1735aacc:auto;" data-v-a87e93d9><!--[--><div class="placeholder-wrapper placeholder" style="" data-v-a87e93d9><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="adfox-banner-placeholder leaderboard" data-v-12f7bcca><div class="image loads" data-v-12f7bcca></div><div class="lines" data-v-12f7bcca><div class="line loads" data-v-12f7bcca></div><div class="line loads" data-v-12f7bcca></div><div class="line loads" data-v-12f7bcca></div></div></div><!----><!----></div><div id="adfox_164725660339535756" class="tm-adfox-banner" data-v-a87e93d9></div><!--]--></div><!--]--><!--]--><div class="tm-article-blocks__comments"><div id="publication-comments" class="tm-article-page-comments"><div><!--[--><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/articles/866254/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style" data-test-id="counter-comments"><!--[--><svg class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted" height="24" width="24"><title>Комментарии</title><use xlink:href="/img/megazord-v28.7909a852..svg#counter-comments"></use></svg><span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментарии 1 </span><!--]--></a><!----></div><!--]--></div></div></div><!--[--><!--[--><!--]--><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><!--[--><!--[--><div class="tm-tabs tm-tabs"><div class=""><!--[--><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim tm-tabs__tab-link">Лучшие за сутки</button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link_slim tm-tabs__tab-link">Похожие</button></span><!--]--></div><!----></div><div class="similar-and-daily__tab-view"><div class="daily-articles-list"><ul class="tm-article-card-list"><!--[--><!--]--><div class="tm-bordered-card"><!----><!--[--><!--]--></div></ul><div class="daily-articles-block__button-container"><button class="btn btn_transparent btn_small tm-button tm-button_color-horizon" type="button"><!--[--><!--[-->Показать лучшие за всё время<!--]--><!--]--></button></div></div><!----></div><!--]--><!--]--></div><!--]--><!----></section><!--[--><section class="tm-block tm-block tm-block_spacing-around tm-stories-block" data-navigatable tabindex="0" data-async-called="true"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Истории</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-equal"><!--[--><div class="tm-stories-empty"><!--[--><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div><div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div><div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div><div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div><div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div><div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div><div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div><div class="tm-stories-card-empty__title-block"></div></div></div><!--]--></div><!----><!--]--></div><!--]--><!----></section><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-inset tm-placeholder-tasks"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div><div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><!--[--><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div><div class="tm-project-block-items__properties"><!--[--><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width:100px;"></span></span><!--]--></div></li><!--]--></ul></div><div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div><!--]--><!----><!--[--><div><div class="placeholder-wrapper"><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div><div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div><div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div><div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div><div class="tm-placeholder-promo__dot"></div><div class="tm-placeholder-promo__dot"></div></div></div></div><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----></div></div><section class="tm-block tm-block tm-block_spacing-top" data-async-called="true"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Работа</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body"><!--[--><!--[--><div class="tm-vacancies-block__item"><a class="tm-vacancies-block__vacancy-title" href="https://career.habr.com/vacancies/php_programmist" target="_blank">PHP программист</a><div class="tm-vacancies-block__vacancies-count">86
    вакансий</div></div><div class="tm-vacancies-block__item"><a class="tm-vacancies-block__vacancy-title" href="https://career.habr.com/vacancies/programmist_laravel" target="_blank">Разработчик Laravel</a><div class="tm-vacancies-block__vacancies-count">23
    вакансии</div></div><!--]--><!--]--></div><!--]--><footer class="tm-block__footer"><!--[--><a class="tm-block-extralink" href="https://career.habr.com/catalog">Все вакансии</a><!--]--></footer></section><section class="tm-block tm-block tm-block_spacing-around tm-events-block" data-navigatable tabindex="0" data-async-called="true"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless-large"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Ближайшие события</h2><!--[--><!--]--></div><!----></header><!--[--><div class="tm-block__body tm-block__body tm-block__body_variant-equal"><!--[--><div class="swiper-container tm-events-widget" style="--swiper-space-between:22px;"><div class="swiper-wrapper"><!--[--><!--[--><div class="swiper-slide"><!--[--><section class="tm-block tm-block tm-block_spacing-none" id="560" tabindex="-1"><!----><!--[--><div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><a href="/ru/events/560/" class=""><img alt class="tm-event-card__image" data-src="https://habrastorage.org/getpro/habr/upload_files/8b1/7fd/042/8b17fd0425f4ae26bfc2422966f3d1c0.jpeg" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/8b1/7fd/042/8b17fd0425f4ae26bfc2422966f3d1c0.jpeg" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/8b1/7fd/042/8b17fd0425f4ae26bfc2422966f3d1c0.jpeg, https://habrastorage.org/getpro/habr/upload_files/8b1/7fd/042/8b17fd0425f4ae26bfc2422966f3d1c0.jpeg 2x"></a><!----><div class="tm-event-card__info"><div class="tm-event-card__date"><!----><div class="tm-event-card__day"><span>2 – 18  декабря  </span></div></div><a href="/ru/events/560/" class="tm-event-card__title-link"><span>Yandex DataLens Festival 2024</span></a><div class="tm-event-card__places"><div class="tm-event-card__places-list"><!--[--><span class="tm-event-card__places-item"><span>Москва</span><span class="tm-event-card__places-separator"> • </span></span><span class="tm-event-card__places-item"><span>Онлайн</span><!----></span><!--]--></div></div></div><div class="tm-event-card__footer tm-event-card__footer_widget"><a href="/ru/events/#560" class="tm-event-card__link">Больше событий в календаре</a><div class="tm-event-card__categories"><!--[--><div class="event-category__label event-category__label_type-development"><span>Разработка</span></div><div class="event-category__label event-category__label_type-management"><span>Менеджмент</span></div><div class="event-category__label event-category__label_type-analytics"><span>Аналитика</span></div><!--]--></div></div></div><!--]--><!----></section><!--]--></div><div class="swiper-slide"><!--[--><section class="tm-block tm-block tm-block_spacing-none" id="566" tabindex="-1"><!----><!--[--><div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><a href="/ru/events/566/" class=""><img alt class="tm-event-card__image" data-src="https://habrastorage.org/getpro/habr/upload_files/e77/90b/4c4/e7790b4c4b1eac0ff361cada2d48721f.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/e77/90b/4c4/e7790b4c4b1eac0ff361cada2d48721f.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/e77/90b/4c4/e7790b4c4b1eac0ff361cada2d48721f.png, https://habrastorage.org/getpro/habr/upload_files/e77/90b/4c4/e7790b4c4b1eac0ff361cada2d48721f.png 2x"></a><!----><div class="tm-event-card__info"><div class="tm-event-card__date"><!----><div class="tm-event-card__day"><span>2 – 15  декабря  </span></div></div><a href="/ru/events/566/" class="tm-event-card__title-link"><span>Вызов от Хекслета и Хабр Карьеры</span></a><div class="tm-event-card__places"><div class="tm-event-card__places-list"><!--[--><span class="tm-event-card__places-item"><span>Онлайн</span><!----></span><!--]--></div></div></div><div class="tm-event-card__footer tm-event-card__footer_widget"><a href="/ru/events/#566" class="tm-event-card__link">Больше событий в календаре</a><div class="tm-event-card__categories"><!--[--><div class="event-category__label event-category__label_type-development"><span>Разработка</span></div><div class="event-category__label event-category__label_type-analytics"><span>Аналитика</span></div><div class="event-category__label event-category__label_type-testing"><span>Тестирование</span></div><!--]--></div></div></div><!--]--><!----></section><!--]--></div><div class="swiper-slide"><!--[--><section class="tm-block tm-block tm-block_spacing-none" id="556" tabindex="-1"><!----><!--[--><div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><a href="/ru/events/556/" class=""><img alt class="tm-event-card__image" data-src="https://habrastorage.org/getpro/habr/upload_files/94b/630/102/94b630102f2be1004ae59e84ea52419e.jpg" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/94b/630/102/94b630102f2be1004ae59e84ea52419e.jpg" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/94b/630/102/94b630102f2be1004ae59e84ea52419e.jpg, https://habrastorage.org/getpro/habr/upload_files/94b/630/102/94b630102f2be1004ae59e84ea52419e.jpg 2x"></a><!----><div class="tm-event-card__info"><div class="tm-event-card__date"><!----><div class="tm-event-card__day"><span>11 – 13  декабря  </span></div></div><a href="/ru/events/556/" class="tm-event-card__title-link"><span>Международная конференция по AI/ML «AI Journey»</span></a><div class="tm-event-card__places"><div class="tm-event-card__places-list"><!--[--><span class="tm-event-card__places-item"><span>Москва</span><span class="tm-event-card__places-separator"> • </span></span><span class="tm-event-card__places-item"><span>Онлайн</span><!----></span><!--]--></div></div></div><div class="tm-event-card__footer tm-event-card__footer_widget"><a href="/ru/events/#556" class="tm-event-card__link">Больше событий в календаре</a><div class="tm-event-card__categories"><!--[--><div class="event-category__label event-category__label_type-development"><span>Разработка</span></div><div class="event-category__label event-category__label_type-other"><span>Другое</span></div><!--]--></div></div></div><!--]--><!----></section><!--]--></div><div class="swiper-slide"><!--[--><section class="tm-block tm-block tm-block_spacing-none" id="516" tabindex="-1"><!----><!--[--><div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><a href="/ru/events/516/" class=""><img alt class="tm-event-card__image" data-src="https://habrastorage.org/getpro/habr/upload_files/0e9/3a8/3ec/0e93a83ecea09f806d1df907ddb036a4.jpg" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/0e9/3a8/3ec/0e93a83ecea09f806d1df907ddb036a4.jpg" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/0e9/3a8/3ec/0e93a83ecea09f806d1df907ddb036a4.jpg, https://habrastorage.org/getpro/habr/upload_files/0e9/3a8/3ec/0e93a83ecea09f806d1df907ddb036a4.jpg 2x"></a><!----><div class="tm-event-card__info"><div class="tm-event-card__date"><!----><div class="tm-event-card__day"><span>25 – 26  апреля  </span></div></div><a href="/ru/events/516/" class="tm-event-card__title-link"><span>IT-конференция Merge Tatarstan 2025</span></a><div class="tm-event-card__places"><div class="tm-event-card__places-list"><!--[--><span class="tm-event-card__places-item"><span>Казань</span><!----></span><!--]--></div></div></div><div class="tm-event-card__footer tm-event-card__footer_widget"><a href="/ru/events/#516" class="tm-event-card__link">Больше событий в календаре</a><div class="tm-event-card__categories"><!--[--><div class="event-category__label event-category__label_type-development"><span>Разработка</span></div><div class="event-category__label event-category__label_type-marketing"><span>Маркетинг</span></div><div class="event-category__label event-category__label_type-other"><span>Другое</span></div><!--]--></div></div></div><!--]--><!----></section><!--]--></div><!--]--><!--]--></div><!----><!--[--><button class="swiper-button-prev"><span class="tm-svg-icon__wrapper swiper-button-icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Влево</title><use xlink:href="/img/megazord-v28.7909a852..svg#arrow-back"></use></svg></span></button><button class="swiper-button-next"><span class="tm-svg-icon__wrapper swiper-button-icon"><svg class="tm-svg-img tm-svg-icon" height="24" width="24"><title>Вправо</title><use xlink:href="/img/megazord-v28.7909a852..svg#arrow-back"></use></svg></span></button><!--]--></div><!--]--></div><!--]--><!----></section><!--]--><!--]--></div><!--]--><!--]--></div></div><!--]--><!--]--></div></div><div class="tm-page__sidebar"><!--[--><!----><!--]--></div></div><!----><!--]--></div><!----></div></main><!----></div><!----><div class="tm-footer"><div class="tm-page-width"><!--[--><div class="tm-footer__container"><div class="tm-footer__title"><a class="tm-svg-icon__wrapper tm-footer__title-link" href="/ru/"><svg class="tm-svg-img tm-svg-icon" height="16" width="16"><title>Хабр</title><use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a></div><div class="tm-footer__social"><!--[--><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Facebook</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Twitter</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>VK</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Telegram</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Youtube</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a class="tm-svg-icon__wrapper tm-social-icons__icon" href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank"><svg class="tm-svg-img tm-svg-icon" height="36" width="36"><title>Яндекс Дзен</title><use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a><!--]--></div><!--teleport start--><!--teleport end--><button class="tm-footer__link"><svg class="tm-svg-img tm-footer__icon" height="16" width="16"><title>Язык</title><use xlink:href="/img/megazord-v28.7909a852..svg#lang"></use></svg> Настройка языка</button><a href="/ru/feedback/" class="tm-footer__link">Техническая поддержка</a><div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2024, </span><span class="tm-copyright__name"><a class="tm-copyright__link" href="https://company.habr.com/" rel="noopener" target="_blank">Habr</a></span></span></div></div><!--]--></div></div><!----><!--]--></div><!----></div><script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"866254":{"id":"866254","timePublished":"2024-12-13T07:16:19+00:00","isCorporative":false,"lang":"ru","titleHtml":"Пример HTTP-сервера на PHP с использованием файберов","leadData":{"textHtml":"\u003Cp\u003EПлатформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс \u003Ca href=\"https:\u002F\u002Fwww.php.net\u002Fmanual\u002Fru\u002Fclass.fiber.php\" rel=\"noopener noreferrer nofollow\"\u003EFiber\u003C\u002Fa\u003E, который, согласно \u003Ca href=\"https:\u002F\u002Fwiki.php.net\u002Frfc\u002Ffibers\" rel=\"noopener noreferrer nofollow\"\u003ERFC\u003C\u002Fa\u003E, должен упростить создание конкурентных приложений. Однако, материалов, демонстрирующих использование данного функционала для построения приложений практически нет, напротив, говорится, что файберы - это \u003Cem\u003Eфункционал, предназначенный для использования разработчиками фреймворков\u003C\u002Fem\u003E и приводятся какие-то малоинформативные отрывки кода. В этой статье будет продемонстрирован концептуальный пример конкурентного приложения на PHP с использованием файберов. \u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdc3\u002F633\u002F15f\u002Fdc363315f1719568f38f9e1929260fd0.jpg","fit":"cover","positionY":4,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","typeOf":"system","title":"Из песочницы","data":{"url":null}}],"author":{"id":"4666079","alias":"cleancodemonkey","fullname":"Антон","avatarUrl":null,"speciality":"Backend Developer (PHP)","scoreStats":{"score":5,"votesCount":5},"rating":11,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"donationsMethod":null,"isInBlacklist":null},"statistics":{"commentsCount":1,"favoritesCount":8,"readingCount":340,"score":11,"votesCount":8,"votesCountPlus":8,"votesCountMinus":0},"hubs":[{"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true,"relatedData":null},{"id":"17822","alias":"parallel_programming","type":"collective","title":"Параллельное программирование","titleHtml":"Параллельное программирование","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":{"vote":null,"unreadCommentsCount":0,"bookmarked":false,"canComment":false,"canEdit":false,"canViewVotes":false,"votePlus":{"canVote":false,"isChargeEnough":false,"isKarmaEnough":false,"isVotingOver":false},"voteMinus":{"canVote":false,"isChargeEnough":false,"isKarmaEnough":false,"isVotingOver":false},"canModerateComments":false,"trackerSubscribed":false,"emailSubscribed":false},"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EПлатформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс \u003Ca href=\"https:\u002F\u002Fwww.php.net\u002Fmanual\u002Fru\u002Fclass.fiber.php\" rel=\"noopener noreferrer nofollow\"\u003EFiber\u003C\u002Fa\u003E, который, согласно \u003Ca href=\"https:\u002F\u002Fwiki.php.net\u002Frfc\u002Ffibers\" rel=\"noopener noreferrer nofollow\"\u003ERFC\u003C\u002Fa\u003E, должен упростить создание конкурентных приложений. Однако, материалов, демонстрирующих использование данного функционала для построения приложений практически нет, напротив, говорится, что файберы - это \u003Cem\u003Eфункционал, предназначенный для использования разработчиками фреймворков\u003C\u002Fem\u003E и приводятся какие-то малоинформативные отрывки кода. В этой статье будет продемонстрирован концептуальный пример конкурентного приложения на PHP с использованием файберов. Приложение представляет собой HTTP-сервер, осуществляющий регистрацию и подсчёт анонимных пользователей с выдачей каждому из них JWT-токена (нужно было добавить какую-то функцию с вводом-выводом, а не просто \"Hello-World!\"). В качестве хранилища используется сервер Redis. Прототип характеризуется следующими основными свойствами с точки зрения многозадачности:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eодин HTTP-запрос - один новый файбер, после обработки запроса файбер уничтожается;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eфайберы передают управление друг другу самостоятельно, программист может этим управлять, это \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FCooperative_multitasking\" rel=\"noopener noreferrer nofollow\"\u003Eкооперативная многозадачность\u003C\u002Fa\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eввод-вывод неблокирующий;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eсистемный поток выполнения только один, системные инструменты обеспечения конкурентности (процессы, потоки) внутри приложения не используются, за счёт отсутствия переключений контекста между большим количеством процессов или потоков должна быть обеспечена высокая производительность;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eдля эффективной работы на многоядерном или многопроцессорном окружении стоит запустить несколько инстансов данного приложения за балансировщиком;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eфреймворки ReactPHP\u002FSwoole\u002FAMPHP\u002FWorkerman а также libevent и аналоги не используются намеренно, в первой части статьи поставлена задача обойтись без данных инструментов;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003EРазбор кода прототипа\u003C\u002Fh3\u003E\u003Cp\u003EПолный код прототипа можно получить из \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\" rel=\"noopener noreferrer nofollow\"\u003Eрепозитория\u003C\u002Fa\u003E, в нём предусмотрено окружение на базе Docker Compose.\u003C\u002Fp\u003E\u003Cp\u003EОснова, на которой построен данный прототип - \u003Ca href=\"https:\u002F\u002Fwww.php.net\u002Fmanual\u002Fru\u002Fbook.sockets.php\" rel=\"noopener noreferrer nofollow\"\u003Eсокеты\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fwww.php.net\u002Fmanual\u002Fru\u002Flanguage.fibers.php\" rel=\"noopener noreferrer nofollow\"\u003Eфайберы\u003C\u002Fa\u003E. Сокеты обеспечивают возможность неблокирующего ввода-вывода, файберы обеспечивают конкурентность. Фактически в прототипе реализована кооперативная (не вытесняющая) многозадачность. \u003Ca href=\"https:\u002F\u002Fwww.php.net\u002Fmanual\u002Fru\u002Fbook.stream.php\" rel=\"noopener noreferrer nofollow\"\u003EПотоки PHP\u003C\u002Fa\u003E  было решено не использовать по причине несовершенства их API, которое не позволяет получить код состояния операции ввода-вывода. К тому же, API сокетов очень схож с системными сетевыми функциями Linux, интерфейс которых проверен временем и есть отличные man-страницы.\u003C\u002Fp\u003E\u003Cp\u003EВходная точка в программу - файл \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=bin%2Fserver.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Ebin\u002Fserver.php\u003C\u002Fa\u003E, Она выполняет подключение автолоадера, загрузку переменных окружения из файла \u003Ccode\u003E.env,\u003C\u002Fcode\u003E запуск сервера. Главный цикл сервера, управляющий запуском файберов находится в файле \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FApp.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FApp.php\u003C\u002Fa\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Eprivate function __construct(FiberedHandlerFactory $factory)\n{\n    $this-&gt;handlerCollection = new FiberedHandlerCollection();\n    $this-&gt;factory = $factory;\n    pcntl_async_signals(true);\n    pcntl_signal(SIGINT, [$this, 'interrupt']);\n    $serverSocket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\n    if ($serverSocket === false) {\n        exit('Error creating server socket.');\n    }\n    if (!socket_set_nonblock($serverSocket)) {\n        exit('Error switching socket to the nonblocking mode.');\n    }\n    if (!socket_bind($serverSocket, getenv('HTTP_BIND_HOST'), (int)getenv('HTTP_BIND_PORT'))) {\n        exit('Error binding socket.');\n    }\n    if (!socket_listen($serverSocket, SOMAXCONN)) {\n        exit('Error switching socket to the listening mode.');\n    }\n    $this-&gt;handlerCollection-&gt;push($this-&gt;factory-&gt;createServerHandler($serverSocket, $this-&gt;handlerCollection));\n}\n\npublic function interrupt(): void\n{\n    $this-&gt;interrupted = true;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ качестве аргумента конструктор принимает фабрику обработчиков \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FFiberedHandlerFactory.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FFiberedHandlerFactory.php\u003C\u002Fa\u003E, которые построены на базе файберов. Их работа будет описана далее. Также в первых строках создаётся коллекция обработчиков \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FFiberedHandlerCollection.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FFiberedHandlerCollection.php\u003C\u002Fa\u003E , фактически представляющая собой очередь из обработчиков для выполнения. Вызовы функций \u003Ccode\u003Epcntl_async_signals()\u003C\u002Fcode\u003E и \u003Ccode\u003Epcntl_signal()\u003C\u002Fcode\u003E необходимы для установки обработчика системного сигнала \u003Ccode\u003ESIGINT\u003C\u002Fcode\u003E, чтобы операционная система имела возможность корректно остановить данный сервер. Далее создаётся основной сокет сервера, который сразу переводится в неблокирующий режим и передаётся отдельному обработчику входящий соединений, работающему на базе файбера. \u003C\u002Fp\u003E\u003Cp\u003EДалее предлагаю взглянуть на код главного цикла сервера в файле \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FApp.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FApp.php\u003C\u002Fa\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Epublic function run(): void\n{\n    App::debug(\"HTTP server has been started. Waiting for connections...\");\n    while (true) {\n        $readSockets = $this-&gt;handlerCollection-&gt;getReadSockets();\n        $writeSockets = $this-&gt;handlerCollection-&gt;getWriteSockets();\n        $exceptSockets = $this-&gt;handlerCollection-&gt;getExceptSockets();\n        \u002F\u002Fблокируемся на всех известных сокетах, чтобы процессор не крутил цикл\n        if(false === socket_select(\n                $readSockets,\n                $writeSockets,\n                $exceptSockets,\n                null\n            )) {\n            exit(sprintf('Fatal error: socket_select() call failed: %s', socket_strerror(socket_last_error())));\n        }\n        if ($this-&gt;interrupted) {\n            \u002F\u002Fполучили сигнал завершения работы\n            break;\n        }\n        $fiberedHandlers = $this-&gt;handlerCollection-&gt;getHandlers($readSockets, $writeSockets, $exceptSockets);\n        App::debug(\"Count of fibers: %d\", $this-&gt;handlerCollection-&gt;getCount());\n        foreach ($fiberedHandlers as $fiberedHandler) {\n            $fiberedHandler-&gt;resetSockets();\n            if ($fiberedHandler-&gt;isSuspended()) {\n                $fiberedHandler-&gt;resume();\n            }\n            if (!$fiberedHandler-&gt;isStarted()) {\n                $fiberedHandler-&gt;start();\n            }\n            if ($fiberedHandler-&gt;isTerminated()) {\n                $this-&gt;handlerCollection-&gt;remove($fiberedHandler);\n            }\n        }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЦентральное место в цикле занимает вызов \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E, который позволяет понять, какие из сокетов в приложении готовы к вводу-выводу. В первых строках цикла можно видеть сбор массивов всех сокетов, обработки которых нужно подождать. После вызова \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E в массивах останутся только те сокеты, которые готовы к вводу-выводу. Основной сокет сервера также передаётся в вызов \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E, если он останется в массиве \u003Ccode\u003E$readSockets\u003C\u002Fcode\u003E после вызова, это означает, что появилось новое подключение к серверу. Обработчик новых подключений выделен в самостоятельный файберный обработчик, который работает с обработчиками генерации ответов на HTTP-запросы в конкурентном режиме. Это сделано намеренно, чтобы сервер равномерно принимал новые подключения и выдавал ответы на уже принятые. Важный код обработчика новых соединений \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FNewConnectionsHandler.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FNewConnectionsHandler.php\u003C\u002Fa\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Eprivate function run(): void\n{\n    while (true) {\n        \u002F\u002Fограничение из-за FD_SETSIZE для типа fd_set в системном вызове select()\n        if ($this-&gt;handlerCollection-&gt;getCount() &gt; self::MAX_FIBERS) {\n            Fiber::suspend();\n\n            continue;\n        }\n        $acceptedSocket = socket_accept($this-&gt;serverSocket);\n        if ($acceptedSocket === false) {\n            Fiber::suspend();\n\n            continue;\n        }\n        if (!socket_set_nonblock($acceptedSocket)) {\n            App::error(\"Error switching socket to the nonblocking mode.\");\n            socket_close($acceptedSocket);\n\n            continue;\n        }\n        $this-&gt;handlerCollection-&gt;push($this-&gt;factory-&gt;createRequestHandler($acceptedSocket));\n        Fiber::suspend();\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЗдесь есть свой бесконечный цикл, управление из которого периодически передаётся основному циклу сервера с помощью вызова \u003Ccode\u003EFiber::suspend()\u003C\u002Fcode\u003E. Сокет, появившийся после вызова \u003Ccode\u003Esocket_accept()\u003C\u002Fcode\u003E(получение нового подключения к серверу), также сразу переводится в неблокирующий режим. Для обслуживания принятого сокета с помощью упомянутой фабрики обработчиков \u003Ccode\u003EFiberedHandlerFactory\u003C\u002Fcode\u003E создаётся обработчик принятого соединения, в обязанности которого входит получение и разбор данных HTTP-запроса, вызов шаблонного метода генерации ответа, а также отправка ответа по принятому соединению. \u003C\u002Fp\u003E\u003Cp\u003EВернёмся к основному циклу в файле \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FApp.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FApp.php\u003C\u002Fa\u003E. После \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E приложение вызывает метод\u003Ccode\u003EFiberedRequestHandlerCollection::getHandlersBySockets()\u003C\u002Fcode\u003E, передав в качестве аргумента массив готовых к работе сокетов. Коллекция на основе соответствия сокетов и обработчиков, а также собственных правил выдаёт в качестве ответа на данный вызов массив обработчиков, которые затем будут выполнены:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003E$fiberedHandlers = $this-&gt;handlerCollection-&gt;getHandlers($readSockets, $writeSockets, $exceptSockets);\nApp::debug(\"Count of fibers: %d\", $this-&gt;handlerCollection-&gt;getCount());\nforeach ($fiberedHandlers as $fiberedHandler) {\n    $fiberedHandler-&gt;resetSockets();\n    if ($fiberedHandler-&gt;isSuspended()) {\n        $fiberedHandler-&gt;resume();\n    }\n    if (!$fiberedHandler-&gt;isStarted()) {\n        $fiberedHandler-&gt;start();\n    }\n    if ($fiberedHandler-&gt;isTerminated()) {\n        $this-&gt;handlerCollection-&gt;remove($fiberedHandler);\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EМетоды \u003Ccode\u003EFiberedRequestHandler::isSuspended()\u003C\u002Fcode\u003E, \u003Ccode\u003EFiberedRequestHandler::resume()\u003C\u002Fcode\u003E, \u003Ccode\u003EFiberedRequestHandler::isStarted()\u003C\u002Fcode\u003E, \u003Ccode\u003EFiberedRequestHandler::start()\u003C\u002Fcode\u003E, \u003Ccode\u003EFiberedRequestHandler::isTerminated()\u003C\u002Fcode\u003E, как можно догадаться, являются прокси над одноимёнными методами класса \u003Ccode\u003EFiber\u003C\u002Fcode\u003E. Логика, реализованная в цикле, довольно проста: если обработка файбера была приостановлена - продолжаем, если ещё не начиналась - начинаем,  если она завершилась - нужно удалить данный файберный обработчик из коллекции.\u003C\u002Fp\u003E\u003Ch3\u003EБазовый файберный обработчик HTTP-запросов\u003C\u002Fh3\u003E\u003Cp\u003EТеперь пора поговорить о классе файберного обработчика запросов \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FHttpRequestHandler.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FHttpRequestHandler.php\u003C\u002Fa\u003E. Его функция заключается в получении из сокета и разборе HTTP-запроса, вызове шаблонного метода по генерации ответа на запрос,  сериализации и записи ответа на запрос в сокет. Всё это делается внутри функции, которая передаётся в конструктор файбера:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Epublic function __construct(int $id, Socket $acceptedSocket)\n{\n    $this-&gt;id = $id;\n    $this-&gt;acceptedSocket = $acceptedSocket;\n    $this-&gt;fiber = new Fiber([$this, 'run']);\n    $this-&gt;addReadSocket($acceptedSocket);\n}\n\npublic function __destruct()\n{\n    $this-&gt;closeResources();\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EМетод \u003Ccode\u003Erun()\u003C\u002Fcode\u003E, передаваемый в конструктор файбера в качестве единственного аргумента - коллбэка:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Eprivate function run(): void\n{\n    try {\n        $requestHeaders = $this-&gt;readRequestHeaders();\n        $stream = $this-&gt;readRequestStream($requestHeaders);\n        $this-&gt;handleHttpRequestInternal($stream);\n    } catch (HttpRequestException $e) {\n        $code = $e-&gt;getCode();\n        if (!in_array($code, [400, 500])) {\n            $code = 500;\n        }\n        $this-&gt;sendHttpResponse(new TextResponse($e-&gt;getMessage(), $code));\n    } finally {\n        $this-&gt;closeResources();\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОтдельно стоит отметить чтение HTTP-запроса и его запись. Чтение из сокета производится неблокирующим способом, сначала читаются и проверяются HTTP-заголовки, затем тело. Когда нужно подождать готовности сокета, управление с помощью вызова \u003Ccode\u003EFiber::suspend()\u003C\u002Fcode\u003E отдаётся обратно основному циклу сервера. который может во время ожидания ввода-вывода вызвать другой файберный обработчик из сформированного массива на выполнение или просмотреть список сокетов на предмет к готовности к работе. В этом и заключается основной принцип на котором построена конкурентность в данном приложении - отдать управление, когда оно не нужно и делать что-то полезное, пока ядро системы занимается вводом-выводом и готовит сокет. Если ни один из сокетов не готов (в том числе принимающий новые соединения), то приложение заблокируется на вызове \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E и ничего не будет делать. Данный подход очень похож на реализованный в ReactPHP\u002FSwoole\u002FAMPHP паттерн Реактор, но без применения событийных расширений для PHP. Возможно, в следующих статьях стоит реализовать данную незамысловатую функциональность с помощью перечисленных фреймворков и выполнить сравнение их производительности с данным решением. Код чтения HTTP-заголовков:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Eprivate function readRequestHeaders(): string\n{\n    $requestHeaders = '';\n    $start = time();\n    $byteCounter = 0;\n    while (true) {\n        $headerLine = socket_read($this-&gt;acceptedSocket, 1);\n        if ($headerLine === false) {\n            $errorCode = socket_last_error($this-&gt;acceptedSocket);\n            socket_clear_error($this-&gt;acceptedSocket);\n            if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK])) {\n                $this-&gt;addReadSocket($this-&gt;acceptedSocket);\n                Fiber::suspend();\n                if ($this-&gt;isTimeoutReached($start)) {\n                    App::debugFiber($this, 'Connection timed out while reading request headers. Socket error code: %d. Data: %s', $errorCode, json_encode($requestHeaders));\n                    throw new HttpRequestException('Connection timed out while reading request headers.');\n                }\n\n                continue;\n            }\n            if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {\n                throw new HttpRequestException(sprintf(\"Error reading data: %s\", socket_strerror($errorCode)));\n            }\n        }\n        $byteCounter++;\n        if ($byteCounter &gt; self::MAX_HTTP_HEADERS_SIZE) {\n            throw new HttpRequestException('HTTP Request headers are too large.');\n        }\n        $requestHeaders .= $headerLine;\n        if (str_ends_with($requestHeaders, \"\\r\\n\\r\\n\")\n            || str_ends_with($requestHeaders, \"\\r\\r\")\n            || str_ends_with($requestHeaders, \"\\n\\n\")\n            || strlen($headerLine) === 0) {\n            return $requestHeaders;\n        }\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДля облегчения логики разбора запросов используется реализация стандарта PSR-7 и PSR-17 из пакета \u003Ccode\u003ELaminas\u002FDiactoros\u003C\u002Fcode\u003E, высококачественный код которого отказался очень удобным для решения данной задачи. Реализация поддерживает только те функции протокола HTTP, которые необходимы для построение совсем простого API (GET\u002FPOST методы, \u003Ccode\u003Eapplication\u002Fjson\u003C\u002Fcode\u003E в теле ограниченного размера).\u003C\u002Fp\u003E\u003Cp\u003EМетод \u003Ccode\u003EFiberedRequestHandler::handleHttpRequestInternal()\u003C\u002Fcode\u003E выполняет вызов шаблонного метода (паттерн Template Method) \u003Ccode\u003EFiberedRequestHandler::handleHttpRequest()\u003C\u002Fcode\u003E и отправку ответа в сокет, а также обработку ошибок. Приведём здесь только код отправки ответа в сокет:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Eprivate function sendHttpResponse(ResponseInterface $response): void\n{\n    $responseString = ResponseSerializer::toString($response);\n    $written = 0;\n    $start = time();\n    while ($written &lt; strlen($responseString)) {\n        $buffer = substr($responseString, $written);\n        $result = socket_write($this-&gt;acceptedSocket, $buffer);\n        if ($result === false) {\n            $errorCode = socket_last_error($this-&gt;acceptedSocket);\n            socket_clear_error($this-&gt;acceptedSocket);\n            if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK])) {\n                $this-&gt;addWriteSocket($this-&gt;acceptedSocket);\n                Fiber::suspend();\n                if ($this-&gt;isTimeoutReached($start)) {\n                    App::errorFiber($this,'Connection timed out while sending HTTP response. Socket error code: %d. Bytes written: %d.', $errorCode, $written);\n\n                    return;\n                }\n\n                continue;\n            }\n            if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {\n                App::errorFiber($this, \"Socket error: %s\", socket_strerror($errorCode));\n\n                break;\n            }\n        } else {\n            $written += $result;\n        }\n    }\n\n    App::debugFiber($this, \"Response has been sent.\");\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКод неблокирующей записи в сокет напоминает код чтения. Когда нужно подождать, управление с помощью файбера отдаётся основному циклу программы для выполнения какой-нибудь другой полезной работы вместо ожидания завершения ввода\u002Fвывода.\u003C\u002Fp\u003E\u003Cp\u003EШаблонный метод генерации ответа на HTTP-запрос имеет простую реализацию и предназначен для переопределения в дочерних классах:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003E\u002F** @throws Throwable *\u002F\nprotected function handleHttpRequest(RequestInterface $request): ResponseInterface\n{\n    return new TextResponse(\"Hello from fibered php http server!\\n\");\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3\u003EОбработчик запроса на регистрацию анонимного пользователя и возврат JWT\u003C\u002Fh3\u003E\u003Cp\u003EКласс \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=src%2FJWTRequestHandler.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002FJWTRequestHandler.php\u003C\u002Fa\u003E, наследующий базовый обработчик \u003Ccode\u003EHttpRequestHandler\u003C\u002Fcode\u003E, реализует логику генерации UUID для анонимного пользователя, сохраняет его вместе с датой регистрации в Redis и генерирует JWT-токен, который возвращается в виде ответа на HTTP-запрос. Помимо этого обработчик ведёт подсчёт количества пользователей. Интерес здесь представляет код ввода-вывода данных в Redis. Как можно догадаться, блокирующий драйвер \u003Ccode\u003EPredis\u003C\u002Fcode\u003E здесь не подойдёт, но, к счастью, Redis имеет простой текстовый протокол реализованный в библиотеке clue\u002Fredis-protocol, который отлично работает через неблокирующий TCP-сокет:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Eprivate function connectToRedisUsingSocket(): void\n{\n    $redisSocket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\n    if ($redisSocket === false) {\n\n        return;\n    }\n    if (!socket_set_nonblock($redisSocket)) {\n\n        return;\n    }\n    $start = time();\n    while (true) {\n        $connected = socket_connect($redisSocket, getenv('REDIS_HOST'), (int)getenv('REDIS_PORT'));\n        if (!$connected) {\n            $errorCode = socket_last_error($redisSocket);\n            socket_clear_error($redisSocket);\n            if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK, SOCKET_EALREADY])) {\n                $this-&gt;addWriteSocket($redisSocket);\n                Fiber::suspend(); \u002F\u002Fпередача управления, чтобы программа занималась полезной работой, а не ждала подключения\n                if ($this-&gt;isTimeoutReached($start)) {\n                    App::debugFiber($this, 'Connection timed out while connecting to Redis. Socket error code: %d.', $errorCode);\n                    throw new RuntimeException('Connection timed out while connecting to Redis.');\n                }\n\n                continue;\n            }\n            if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {\n                throw new RuntimeException(sprintf(\"Socket error: %s\", socket_strerror($errorCode)));\n            }\n        }\n        break;\n    }\n    $this-&gt;redisSocket = $redisSocket;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКак и в случае с обработкой HTTP-соединений, используется неблокирующий ввод-вывод. Если возникает операция ввода-вывода, результата которой нужно подождать, эта операция должна быть выполнена в неблокирующем режиме в цикле, с передачей управления основному циклу если ввод-вывод ещё не завершился. Инкремент счётчика пользователей и сохранение данных пользователя в Redis реализованы именно таким способом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003E$requestMessage = $this-&gt;serializer-&gt;getRequestMessage('INCR', ['user_counter']);\n$written = 0;\n$start = time();\nwhile ($written &lt; strlen($requestMessage)) {\n    $buffer = substr($requestMessage, $written);\n    App::debugFiber($this,'Trying to write %s to the socket.', json_encode($buffer));\n    $result = socket_write($redisSocket, $buffer);\n    if ($result === false) {\n        $errorCode = socket_last_error($redisSocket);\n        socket_clear_error($redisSocket);\n        if (in_array($errorCode, [SOCKET_EAGAIN, SOCKET_EWOULDBLOCK])) {\n            $this-&gt;addWriteSocket($redisSocket);\n            Fiber::suspend();\n            if ($this-&gt;isTimeoutReached($start)) {\n                App::debugFiber($this, 'Connection timed out while incrementing counter. Socket error code: %d. Bytes written: %d.', $errorCode, $written);\n                throw new RuntimeException('Connection timed out while incrementing counter.');\n            }\n\n            continue;\n        }\n        if (!in_array($errorCode, [0, SOCKET_EINPROGRESS])) {\n            throw new RuntimeException(sprintf(\"Socket error: %s\", socket_strerror($errorCode)));\n        }\n    } else {\n        $written += $result;\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСтоит отметить, что очень немногие драйверы хранилищ поддерживают такие простые текстовые протоколы взаимодействия. В возможных следующих статьях стоит постараться реализовать взаимодействие с другими хранилищами (может для этого и потребуется как-то доработать их драйверы). Тем не менее, сокеты PHP это уже немало, ведь они фактически представляют собой системные вызовы Linux для работы с сетью, которые используются в качестве транспорта в большинстве драйверов хранилищ.\u003C\u002Fp\u003E\u003Ch3\u003EСравнение с реализацией на базе PHP-FPM\u003C\u002Fh3\u003E\u003Cp\u003EВ качестве кандидата на сравнение решено было использовать реализацию на базе PHP-FPM, которая, учитывая встроенные в PHP-возможности по разбору HTTP-запросов и отправке ответов, а также серверный цикл PHP-FPM, получилась очень простой, в виде одного файла \u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\u002Fblob?file=webroot%2Findex.php&amp;branch=master\" rel=\"noopener noreferrer nofollow\"\u003Ewebroot\u002Findex.php\u003C\u002Fa\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"php\"\u003Erequire __DIR__ . '\u002F..\u002Fvendor\u002Fautoload.php';\n\n$dotenv = Dotenv\\Dotenv::createImmutable(dirname(__DIR__));\n$dotenv-&gt;load();\n\nheader('Content-Type', 'application\u002Fjson');\n\n$predis = new Client([\n    'scheme' =&gt; 'tcp',\n    'host'   =&gt; getenv('REDIS_HOST'),\n    'port'   =&gt; getenv('REDIS_PORT'),\n]);\n\n$counter = $predis-&gt;incr('user_counter');\n\nif ($counter === false) {\n    header('HTTP\u002F1.1 500 Internal Server Error');\n    echo 'Error while incrementing user counter.';\n\n    return;\n}\n\n$user = new User(\n    Uuid::uuid4(),\n    new DateTimeImmutable(),\n    $counter\n);\n\nif (!$predis-&gt;set($user-&gt;getId()-&gt;getHex()-&gt;toString(), json_encode($user, JSON_THROW_ON_ERROR))) {\n    header('HTTP\u002F1.1 500 Internal Server Error');\n    echo 'Error while saving user to Redis.';\n\n    return;\n}\n\n$jwtKey = InMemory::plainText(trim(getenv('JWT_KEY')));\n$tokenBuilder = new Builder(\n    new JoseEncoder(),\n    ChainedFormatter::default()\n);\n$now = $user-&gt;getDate();\n$jwt = $tokenBuilder-&gt;issuedAt($now)\n    -&gt;expiresAt($now-&gt;modify('+1 hour'))\n    -&gt;withHeader('user_id', $user-&gt;getId())\n    -&gt;withHeader('counter', $user-&gt;getCounter())\n    -&gt;getToken(new Sha256(), $jwtKey);\n\necho json_encode([\n    'jwt' =&gt; $jwt-&gt;toString()\n]);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ конфигурацию Docker Compose были добавлены контейнеры Nginx и PHP-FPM, после запуска данный обработчик будет принимать соединения в порт \u003Ccode\u003E8086\u003C\u002Fcode\u003E. Файберная реализация доступна в порту \u003Ccode\u003E8085\u003C\u002Fcode\u003E. Для выполнения нагрузочного тестирования использовалась простая консольная \u003Ca href=\"https:\u002F\u002Fhttpd.apache.org\u002Fdocs\u002Fcurrent\u002Fprograms\u002Fab.html\" rel=\"noopener noreferrer nofollow\"\u003Eутилита Apache Benchmark\u003C\u002Fa\u003E. Далее приводятся отрывки из результатов запуска нагрузочных тестов. Для каждой реализации было выполнено по 10000 запросов в 1000 потоков. Для оценки производительности используется общее время обработки (чем меньше - тем лучше) и количество обрабатываемых запросов в секунду (чем больше - тем лучше). Бенчмарки выполнялись в окружении, развёрнутом при помощи Docker Compose на ноутбуке автора статьи. Для более объективного сравнения количество ядер процессора, используемых контейнерами файберной реализации и PHP-FPM было ограничено 1 ядром.\u003C\u002Fp\u003E\u003Ch3\u003EРезультаты бенчмарка реализации на базе Файберов\u003C\u002Fh3\u003E\u003Cpre\u003E\u003Ccode class=\"bash\"\u003E$ ab -c 1000 -n 10000 http:\u002F\u002Flocalhost:8085\u002F\nServer Software:\nServer Hostname:        localhost\nServer Port:            8085\n\nDocument Path:          \u002F\nDocument Length:        244 bytes\n\nConcurrency Level:      1000\nTime taken for tests:   54.569 seconds\nComplete requests:      10000\nFailed requests:        1020\n   (Connect: 0, Receive: 0, Length: 1020, Exceptions: 0)\nTotal transferred:      2946584 bytes\nHTML transferred:       2436584 bytes\nRequests per second:    183.25 [#\u002Fsec] (mean)\nTime per request:       5456.885 [ms] (mean)\nTime per request:       5.457 [ms] (mean, across all concurrent requests)\nTransfer rate:          52.73 [Kbytes\u002Fsec] received\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОбщее время ~ 55 сек., ~ 183 запроса в секунду.\u003C\u002Fp\u003E\u003Ch3\u003EРезультаты бенчмарка реализации на базе PHP-FPM\u003C\u002Fh3\u003E\u003Cpre\u003E\u003Ccode class=\"bash\"\u003E$ ab -c 1000 -n 10000 http:\u002F\u002Flocalhost:8086\u002F\nServer Software:        nginx\u002F1.27.2\nServer Hostname:        localhost\nServer Port:            8086\n\nDocument Path:          \u002F\nDocument Length:        244 bytes\n\nConcurrency Level:      1000\nTime taken for tests:   94.832 seconds\nComplete requests:      10000\nFailed requests:        1011\n   (Connect: 0, Receive: 0, Length: 1011, Exceptions: 0)\nTotal transferred:      3666659 bytes\nHTML transferred:       2436659 bytes\nRequests per second:    105.45 [#\u002Fsec] (mean)\nTime per request:       9483.242 [ms] (mean)\nTime per request:       9.483 [ms] (mean, across all concurrent requests)\nTransfer rate:          37.76 [Kbytes\u002Fsec] received\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОбщее время ~ 94 сек., ~ 106 запросов в секунду.\u003C\u002Fp\u003E\u003Cp\u003EЕсли вы заметили ошибку в реализации или процессе оценки, которая могла привести к значительным огрехам в результирующих данных - прошу написать об этом в комментариях к статье или сообщить автору с помощью личных сообщений.\u003C\u002Fp\u003E\u003Ch3\u003EИтоги\u003C\u002Fh3\u003E\u003Cp\u003EКак можно видеть из результатов бенчмарков, производительность примера, использующего файберы, оказалась выше реализации на базе PHP-FPM. Безусловно, последняя показала бы себя более эффективно, будучи запущенной на нескольких ядрах, однако реализацию на базе файберов также можно запустить в виде нескольких экземпляров (лучше всего в количестве, равном числу доступных ядер) за балансировщиком, что обеспечит ещё большую производительность на многоядерной или многопроцессорной архитектуре. Также непроанализированным осталось потребление ресурсов. Возможно, его анализ будет приведен в следующих статьях.\u003C\u002Fp\u003E\u003Cp\u003EПредставленный в статье подход пока трудно рекомендовать к использованию в production. Сокеты и \u003Ccode\u003Epctnl\u003C\u002Fcode\u003E включены во многих сборках PHP, однако, константа \u003Ccode\u003EFD_SETSIZE\u003C\u002Fcode\u003E ограничивает количество одновременно обслуживаемых одним вызовом \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E сокетов. При нагрузочном тестировании в три процесса, каждый из которых создавал по 1000 соединений одновременно, не было обнаружено каких-либо проблем, т.к. сокеты быстро обслуживаются и закрываются, ведь это HTTP-сервер, где не нужны постоянные соединения. Кроме того, применение ограничивается малым количеством драйверов хранилищ, поддерживающих неблокирующий ввод-вывод (другие неблокирующие драйверы будут продемонстрированы в следующих статьях). Также стоит отметить низкую популярность неблокирующего ввода-вывода и кооперативной многозадачности среди PHP-разработчиков, по субъективным ощущениям, все ждут какого-то аналога потоков (Thread) и пула потоков (ThreadPool) из Python или Runnable из Java Concurrency. Стоит отметить, что файберы работают в одном потоке, а такие приложения гораздо легче отлаживать, чем многопоточные, отсутствует состояние гонки. Остаётся надеяться, что появление файберов и всё возрастающие требования к времени отклика и устойчивости серверных приложений к нагрузкам в совокупности с требованиями к снижению затрат на непомерно дорожающую инфраструктуру будут способствовать повышению популярности более эффективного конкурентного программирования в PHP-сообществе. В следующей статье будет продемонстрировано развитие данного примера, в котором вызов \u003Ccode\u003Esocket_select()\u003C\u002Fcode\u003E будет заменён на более масштабируемое решение, которое позволит обслуживать гораздо большее количество соединений.\u003C\u002Fp\u003E\u003Ch3\u003EСсылка на репозиторий\u003C\u002Fh3\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgitflic.ru\u002Fproject\u002Fcleancodemonkey\u002Ffabio\" rel=\"noopener noreferrer nofollow\"\u003Ecleancodemonkey\u002Ffabio\u003C\u002Fa\u003E  \u003C\u002Fp\u003E\u003Ch3\u003EМатериалы, использованные при подготовке данной статьи\u003C\u002Fh3\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"http:\u002F\u002Fwww.kegel.com\u002Fc10k.html\" rel=\"noopener noreferrer nofollow\"\u003EThe C10K problem\u003C\u002Fa\u003E  \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwiki.php.net\u002Frfc\u002Ffibers\" rel=\"noopener noreferrer nofollow\"\u003EPHP: rfc:fibers\u003C\u002Fa\u003E  \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fpiter\u002Farticles\u002F839526\u002F\" rel=\"noopener noreferrer nofollow\"\u003EКнига: «Грокаем конкурентность» \u002F Хабр\u003C\u002Fa\u003E  \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=Q2H-7S1tySM\" rel=\"noopener noreferrer nofollow\"\u003EКооперативная многозадачность\u003C\u002Fa\u003E  \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"php"},{"titleHtml":"fiber"},{"titleHtml":"non-blocking"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F866254\u002Fb483cf46205a034b2dd6194dc10b5bff\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F866254\u002Fb483cf46205a034b2dd6194dc10b5bff\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F866254\\\u002F\"},\"headline\":\"Пример HTTP-сервера на PHP с использованием файберов\",\"datePublished\":\"2024-12-13T10:16:19+03:00\",\"dateModified\":\"2024-12-13T10:16:19+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Антон\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber, котор...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F866254\\\u002F#post-content-body\",\"about\":[\"h_php\",\"h_parallel_programming\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F866254\\\u002Fb483cf46205a034b2dd6194dc10b5bff\\\u002F\"]}","metaDescription":"Платформа PHP часто подвергается критике за отсутствие встроенных возможностей для создания конкурентных приложений. В версии 8.1 был добавлен класс Fiber , который, согласно RFC , должен упростить...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":{"status":true,"reason":null},"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":null,"banner":null,"multiwidget":null,"multiwidgetUuid":null,"readingTime":15,"complexity":"high","isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"postReasonsList":null,"view":"list","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"viewedPosts":[],"myFeedFilter":{"complexity":"all","score":"all","types":["articles","posts","news"]},"myFeedIsApplyFilters":false,"myFeedIsForce":false,"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"PHP программист","vacanciesCount":86,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fphp_programmist","itemHubs":["laravel","symfony","yii","php"]},{"title":"Разработчик Laravel","vacanciesCount":23,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fprogrammist_laravel","itemHubs":["laravel","php"]}],"hubs":"php,parallel_programming"},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companyAdd":{"currentStep":"","stepsData":{},"uncompletedSteps":[],"isStepLoading":true,"isStepCommitting":false,"isInitialized":false,"agreementContent":""},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"pagesCount":0},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"fixedBanner":{"isArticleStickyPanelVisible":false,"isArticleStickyPanelAtTheBottom":false,"isFixedBannerVisible":false,"isStickyPanelIconsHidden":false},"flows":{"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}],"updates":{}},"global":{"isPwa":false,"device":"mobile","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"welcomePage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"query":{},"pathname":"\u002Fru\u002Farticles\u002F866254\u002F","path":"\u002Fru\u002Farticles\u002F866254\u002F","href":"\u002Fru\u002Farticles\u002F866254\u002F"}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null,"userUpdates":{"feeds":{"newPostsCount":null,"newThreadsCount":null,"newNewsCount":null,"newCount":null},"conversationUnreadCount":0}},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"onboarding":{"currentStep":null,"stepsData":{"greetings":{"reason":null}},"stepsErrors":{},"completedSteps":[],"isStepCommitting":false,"isCommitDisabled":true},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"tasks":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null,"sticker":null},"publicationStatistics":{"statsInfo":{},"statsFunnels":{},"statsGraph":{},"defaultSuggest":{},"suggest":{},"timeTracker":{},"isTrackingActivity":false,"isUserActive":true},"pullRefresh":{"shouldRefresh":false},"reactions":{"reactionCounters":{"866254":{"publicationId":"866254","reactions":[],"totalCount":0}},"reactionPacks":[{"id":"2","customer":{"id":"1","title":"K2 Cloud","url":"https:\u002F\u002Fu.habr.com\u002Fk2cloud_mod1\u002F?erid=2VSb5xuLB12","logoUrl":"\u002Fimg\u002Fsponsors\u002Fk2Cloud.svg"},"title":"K2 Cloud","isAds":true,"isActive":true,"relatedData":{"isAllowed":false},"reactions":[{"id":"6","title":"Круто!","imageUrl":"\u002Fimg\u002Freactions\u002Fsunglasses.lottie","isActive":true},{"id":"7","title":"?","imageUrl":"\u002Fimg\u002Freactions\u002Fthinking_face.lottie","isActive":true},{"id":"8","title":"Огонь","imageUrl":"\u002Fimg\u002Freactions\u002Ffire.lottie","isActive":true},{"id":"9","title":"Сильно!","imageUrl":"\u002Fimg\u002Freactions\u002Fmuscle.lottie","isActive":true},{"id":"10","title":"Устал","imageUrl":"\u002Fimg\u002Freactions\u002Fmelting_face.lottie","isActive":true}]},{"id":"1","customer":null,"title":"Стандартные","isAds":false,"isActive":true,"relatedData":{"isAllowed":true},"reactions":[{"id":"1","title":"Нравится","imageUrl":"\u002Fimg\u002Freactions\u002Fheart_eyes.lottie","isActive":true},{"id":"2","title":"Смешно","imageUrl":"\u002Fimg\u002Freactions\u002Fjoy.lottie","isActive":true},{"id":"3","title":"Ого!","imageUrl":"\u002Fimg\u002Freactions\u002Fopen_mouth.lottie","isActive":true},{"id":"4","title":"Грустно","imageUrl":"\u002Fimg\u002Freactions\u002Fcry.lottie","isActive":true},{"id":"5","title":"Не нравится","imageUrl":"\u002Fimg\u002Freactions\u002Fface_with_symbols_on_mouth.lottie","isActive":true}]}],"isReactionPacksLoading":false,"reactionsData":{},"reactionDataLoading":{}},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":true,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-932","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6b8\u002F029\u002Fb95\u002F6b8029b9515324dbccf45e5a61634816.png","title":"Контур.Диадок","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88"},"title":"Спасибо, КЭП","lang":"ru","startTime":"2024-12-13T11:40:00+03:00","finishTime":"2024-12-27T23:59:00+03:00","slides":[{"id":"story-932_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1cd\u002F7b6\u002F3a3\u002F1cd7b63a37b6c4eb1c13f211b35673f8.png","button":null},{"id":"story-932_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc00\u002Feac\u002Fff6\u002Fc00eacff629d0b3ecc5782e2389ad42f.png","button":{"title":"Взойти на борт","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88","colorType":"light"}},{"id":"story-932_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa79\u002F7d8\u002F502\u002Fa797d8502de873f7937a95c09ecee482.png","button":{"title":"Долететь в моменте","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88","colorType":"light"}},{"id":"story-932_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F71b\u002Ff5c\u002F922\u002F71bf5c9228e5f54d1ba96fcbc8045b4a.png","button":null},{"id":"story-932_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F25c\u002Fecc\u002Fb3a\u002F25ceccb3ae95d039297de5d7c2377a73.png","button":null},{"id":"story-932_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc22\u002F27e\u002Faf4\u002Fc2227eaf42fe826059bdb785d1034fe4.png","button":{"title":"Добро пожаловать","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88","colorType":"light"}},{"id":"story-932_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F250\u002F924\u002F345\u002F2509243458dc49311ec22e4477952d3c.png","button":null},{"id":"story-932_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4e6\u002Fed8\u002F0f1\u002F4e6ed80f14780562802c7e9e6458e3c5.png","button":{"title":"Получить документы","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88","colorType":"light"}},{"id":"story-932_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F924\u002F547\u002F5c5\u002F9245475c55bb4f2255e44863ece098a5.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88","colorType":"light"}},{"id":"story-932_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb38\u002F860\u002Fff3\u002Fb38860ff308647a7a9edf17dd7849787.png","button":{"title":"Попробуйте бесплатно","link":"https:\u002F\u002Fu.habr.com\u002Fuzx88","colorType":"dark"}}]},{"id":"story-930","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9b3\u002F511\u002F93b\u002F9b351193b33a7e856f4ae0f863c7f1fa.png","title":"Инфосистемы Джет","link":"https:\u002F\u002Fu.habr.com\u002Fjetstories\u002F?erid=2VSb5ybDTFn\u002F"},"title":"Неполадки в ночном дата-центре","lang":"ru","startTime":"2024-12-12T16:05:00+03:00","finishTime":"2024-12-19T16:05:08+03:00","slides":[{"id":"story-930_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9ba\u002F684\u002F3fd\u002F9ba6843fd9b8e0918f35eee5bc256b67.jpg","button":{"title":"Устранить неполадки","link":"https:\u002F\u002Fu.habr.com\u002Fjetstories\u002F?erid=2VSb5ybDTFn\u002F","colorType":"light"}},{"id":"story-930_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F188\u002Fd00\u002F208\u002F188d002087ce4269ef47b88df02fcb36.jpg","button":null},{"id":"story-930_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F16f\u002F772\u002F6af\u002F16f7726af78e69c953ae2c83b1e4945f.jpg","button":null},{"id":"story-930_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0e4\u002Fccb\u002Ffc1\u002F0e4ccbfc103e1af9c10e1139af2acbcd.jpg","button":{"title":"Проверить знания","link":"https:\u002F\u002Fu.habr.com\u002Fjetstories\u002F?erid=2VSb5ybDTFn\u002F","colorType":"light"}},{"id":"story-930_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F83e\u002F984\u002Ff86\u002F83e984f8653cd5d77ad1d96c0c4e5105.jpg","button":{"title":"Вход в дата-центр","link":"https:\u002F\u002Fu.habr.com\u002Fjetstories\u002F?erid=2VSb5ybDTFn\u002F","colorType":"light"}}]},{"id":"story-928","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff46\u002Fd9e\u002Fa14\u002Ff46d9ea1442ea7c07ce976de68aacb0b.png","title":"StartupDrive","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrvblog"},"title":"Космическая акселерация","lang":"ru","startTime":"2024-12-12T10:50:00+03:00","finishTime":"2024-12-19T16:43:25+03:00","slides":[{"id":"story-928_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fedb\u002F90a\u002F0a7\u002Fedb90a0a77e0ada44c39a17ba3d3e942.png","button":{"title":"Вывести MVP на рынок","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F535\u002Fcf1\u002F0dc\u002F535cf10dca328cfeea585631732738ea.png","button":{"title":"Гиперпрыжок!","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fef6\u002F457\u002Fe7d\u002Fef6457e7d0cd937a58f46e408133d0bf.png","button":{"title":"Пройти препятствия","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F643\u002Fcb4\u002F4ec\u002F643cb44ec96be8270cc657ba3d5391d5.png","button":{"title":"Соблюсти баланс","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7c2\u002F74d\u002F7aa\u002F7c274d7aa737fee10eba517806d01eb5.png","button":{"title":"Мимо чёрной дыры","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F883\u002F5d4\u002Ff11\u002F8835d4f1108230de52170627c6634195.jpg","button":{"title":"Курс на акселерацию","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F812\u002Fe12\u002F2b4\u002F812e122b46563b55f79b832916d54df8.png","button":{"title":"Найти акселератор","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F555\u002Fa84\u002Ff35\u002F555a84f357d106e8e0fc96718099826b.png","button":{"title":"Получить совет","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9d8\u002Fbf1\u002F5f1\u002F9d8bf15f133f6a435d186784e8ee08cb.png","button":{"title":"Ускорение на полную!","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}},{"id":"story-928_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff34\u002F569\u002F8ec\u002Ff345698ecf10a265cebf676bcd212f69.png","button":{"title":"Вывести MVP на рынок","link":"https:\u002F\u002Fu.habr.com\u002Fstories_strtpdrv","colorType":"light"}}]},{"id":"story-926","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F93e\u002F78d\u002F3d1\u002F93e78d3d12d9483a0706be1b654d9a16.png","title":"Гринатом","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC"},"title":"Магия тестировщиков зовет","lang":"ru","startTime":"2024-12-11T17:00:00+03:00","finishTime":"2024-12-20T23:59:00+03:00","slides":[{"id":"story-926_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff50\u002Fc92\u002F4ab\u002Ff50c924abd339d69dd6cb46ea215cbdc.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F841\u002F7c0\u002F222\u002F8417c02221d41f62cbe691845e6cf5af.jpg","button":{"title":"Проверить","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F563\u002Ff26\u002F692\u002F563f26692e27feea2526f5758e639ef1.jpg","button":null},{"id":"story-926_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F039\u002F3e6\u002F722\u002F0393e67223258b50dfd669cfd05d164d.jpg","button":{"title":"Конечно, нет","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa5b\u002F15b\u002Ff8b\u002Fa5b15bf8beebc2cea99747cf524b66cd.jpg","button":{"title":"Протестировать магию","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F408\u002Ff37\u002Fb69\u002F408f37b69c3deb46329a54585fae03a3.jpg","button":{"title":"За работу","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9bc\u002F438\u002F087\u002F9bc4380870a9d77fa537af40910ea11e.jpg","button":{"title":"Здесь плюшки","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F442\u002F747\u002F8b5\u002F4427478b5e38bf03b6553d7c0a02de5c.jpg","button":{"title":"В дорогу","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}},{"id":"story-926_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8bc\u002Fa18\u002F9a8\u002F8bca189a892b234dcc9cd29f419531de.jpg","button":null},{"id":"story-926_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6c0\u002F813\u002F889\u002F6c0813889b5fd781f3e0d625f4c3e298.jpg","button":{"title":"Присоединиться","link":"https:\u002F\u002Fu.habr.com\u002FZU8SC","colorType":"light"}}]},{"id":"story-924","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Faf1\u002F73d\u002F676\u002Faf173d6762466af530a9ac9c7bd8e4d8.png","title":"Гринатом","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu"},"title":"С высоты аналитического полета","lang":"ru","startTime":"2024-12-11T15:46:00+03:00","finishTime":"2024-12-20T23:59:00+03:00","slides":[{"id":"story-924_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4db\u002F4fb\u002F7fa\u002F4db4fb7fa44cae953d89920a602653be.jpg","button":{"title":"Залететь на Атомкор","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"dark"}},{"id":"story-924_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc95\u002Fd27\u002F4b9\u002Fc95d274b9a130179e41b8c6105528725.jpg","button":{"title":"Узнать подробнее","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"light"}},{"id":"story-924_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2f9\u002F7de\u002F2a5\u002F2f97de2a5f0a8dbb42e9329aa758ea70.jpg","button":{"title":"Атомкор на связи","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"light"}},{"id":"story-924_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fecb\u002F6bf\u002F8cf\u002Fecb6bf8cf089a3f55508de58f70a27f8.jpg","button":null},{"id":"story-924_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F355\u002F054\u002Fe16\u002F355054e16a5f1089805c45eb24e06e97.jpg","button":{"title":"Держать курс","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"dark"}},{"id":"story-924_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F42f\u002F643\u002Fcdc\u002F42f643cdc2f5238fd5fc1468b2b62f4f.jpg","button":null},{"id":"story-924_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbff\u002F3b7\u002F52f\u002Fbff3b752f5f5c699befb08bca0a98171.jpg","button":{"title":"Пора в Атомкор","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"light"}},{"id":"story-924_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7e6\u002F09b\u002F12d\u002F7e609b12de970f103010af292c3c1409.jpg","button":{"title":"У меня тоже","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"light"}},{"id":"story-924_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3fc\u002F7df\u002F60a\u002F3fc7df60aa8066867348630c256dacdd.jpg","button":{"title":"Присоединиться","link":"https:\u002F\u002Fu.habr.com\u002FmJLiu","colorType":"light"}}]},{"id":"story-920","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F518\u002F064\u002F203\u002F518064203c9ad79b3287f2d3ed33ffca.png","title":"Сбер","link":"https:\u002F\u002Fu.habr.com\u002FTgjnV"},"title":"Трансляция из мира AI","lang":"ru","startTime":"2024-12-10T13:50:00+03:00","finishTime":"2024-12-20T23:59:00+03:00","slides":[{"id":"story-920_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F66e\u002Fb4b\u002F20e\u002F66eb4b20eec7ce03e24484d6801d1b68.png","button":null},{"id":"story-920_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffc5\u002F4a2\u002F372\u002Ffc54a23723dd89686fe65d8392d185c6.png","button":{"title":"Исследовать","link":"https:\u002F\u002Fu.habr.com\u002FTgjnV","colorType":"light"}},{"id":"story-920_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F926\u002F315\u002Ffa2\u002F926315fa28aa2bc3fa2ac6b771045b8b.png","button":{"title":"Изучить","link":"https:\u002F\u002Fu.habr.com\u002FTgjnV","colorType":"light"}},{"id":"story-920_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F88e\u002Fe28\u002Fac0\u002F88ee28ac045463cd56d6a8decf806bc5.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FTgjnV","colorType":"light"}},{"id":"story-920_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F255\u002F39f\u002F352\u002F25539f35295db2e4611c4e9bb8470dfa.png","button":{"title":"Интересно","link":"https:\u002F\u002Fu.habr.com\u002FTgjnV","colorType":"light"}}]},{"id":"story-918","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbee\u002F277\u002F556\u002Fbee277556b28378aa37f322c3406138a.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002FJWIJI"},"title":"Microsoft представила ИИ для генерации 3D","lang":"ru","startTime":"2024-12-10T12:53:00+03:00","finishTime":"2024-12-17T12:53:45+03:00","slides":[{"id":"story-918_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1f0\u002F84b\u002F570\u002F1f084b570509734fe7ba689d90680131.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002FJWIJI","colorType":"dark"}},{"id":"story-918_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa7e\u002F588\u002Ff76\u002Fa7e588f76c2099a6954e9b4310e7e445.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fu.habr.com\u002FJWIJI","colorType":"dark"}},{"id":"story-918_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff20\u002F67b\u002F16d\u002Ff2067b16d88101b5ae6588bf01c9912c.jpg","button":{"title":"Подробности","link":"https:\u002F\u002Fu.habr.com\u002FJWIJI","colorType":"dark"}}]},{"id":"story-916","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fae2\u002Fa60\u002Fb73\u002Fae2a60b736390704cdc9478ff08073b9.png","title":"Хабр","link":null},"title":"Годнота из блогов компаний","lang":"ru","startTime":"2024-12-09T16:47:00+03:00","finishTime":"2024-12-20T16:47:00+03:00","slides":[{"id":"story-916_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F80f\u002Fefd\u002Fd8f\u002F80fefdd8f82b37c74fc03f6a924dcb5f.jpg","button":null},{"id":"story-916_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdd1\u002Fd5d\u002F7b4\u002Fdd1d5d7b44d1e67dce1dab7e9af4d1ea.jpg","button":{"title":"Что получилось?","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Ftimeweb\u002Farticles\u002F818645\u002F","colorType":"light"}},{"id":"story-916_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F484\u002Fb4c\u002F335\u002F484b4c33579211d6cb39a8b2807321f6.jpg","button":{"title":"Который час?","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fyandex\u002Farticles\u002F861538\u002F","colorType":"dark"}},{"id":"story-916_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F814\u002Fcb5\u002Fbaf\u002F814cb5baf2097ba026b2d55bd9d6eea2.jpg","button":{"title":"Подробности","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fozontech\u002Farticles\u002F859936\u002F","colorType":"dark"}},{"id":"story-916_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Febc\u002F42f\u002F14e\u002Febc42f14e7ce9a7334b430f5ea18319f.jpg","button":{"title":"Гласит","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fomk-it\u002Farticles\u002F860196\u002F","colorType":"light"}},{"id":"story-916_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe57\u002F387\u002F1e1\u002Fe573871e1dd2864714ab3aef7eaa7637.jpg","button":{"title":"Примеры","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fpostgrespro\u002Farticles\u002F852414\u002F","colorType":"light"}},{"id":"story-916_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F030\u002Fd67\u002F1b2\u002F030d671b2296fbe476e2efd71f9a3072.jpg","button":{"title":"Путевые записки","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fru_mts\u002Farticles\u002F858830\u002F","colorType":"light"}},{"id":"story-916_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F74d\u002Fb89\u002F133\u002F74db8913319cb1bff78244ed4d81e3f1.jpg","button":{"title":"Неочевидное","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fruvds\u002Farticles\u002F859422\u002F","colorType":"light"}}]},{"id":"story-914","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb6b\u002F264\u002F13b\u002Fb6b26413bd6deed22a317efe53417f72.png","title":"Рунити","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1"},"title":"Настрой work-life balance","lang":"ru","startTime":"2024-12-05T17:48:00+03:00","finishTime":"2024-12-19T23:59:00+03:00","slides":[{"id":"story-914_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F012\u002F274\u002F6b5\u002F0122746b5d9e5db29ff0d6f5c1fb4a1d.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"light"}},{"id":"story-914_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F46a\u002Fe96\u002F19f\u002F46ae9619fd710330c9fc09866692a32a.png","button":null},{"id":"story-914_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F003\u002F096\u002F6fe\u002F0030966fe40039c997972fc786ab9529.png","button":{"title":"Хочу тоже","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"light"}},{"id":"story-914_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa69\u002F20b\u002F3bd\u002Fa6920b3bd98b9afd90d3ba9a68eda4ac.png","button":{"title":"Интересно","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"dark"}},{"id":"story-914_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb00\u002F8f5\u002F372\u002Fb008f53729d066de224ca977100211f7.png","button":null},{"id":"story-914_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F866\u002F296\u002F0c7\u002F8662960c7188dcf4db6cc0fb0eab4072.png","button":{"title":"Достать артефакты","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"light"}},{"id":"story-914_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fafa\u002F05f\u002Ff57\u002Fafa05ff57db9cd78a2ad760f757e7333.png","button":null},{"id":"story-914_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4ea\u002Fe71\u002F318\u002F4eae7131860add8fb6e5c506cb6290c6.png","button":{"title":"Расколдуй переработу","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"dark"}},{"id":"story-914_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6ba\u002F8f6\u002Fd02\u002F6ba8f6d022e86b8bd3c183b612e40fa7.png","button":{"title":"Ура, расколдовал","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"light"}},{"id":"story-914_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F80b\u002F1d5\u002F487\u002F80b1d5487d00028ab5a3fdb8c0dbcc3d.png","button":{"title":"Выбирай свой баланс","link":"https:\u002F\u002Fu.habr.com\u002FgcvF1","colorType":"light"}}]},{"id":"story-908","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F92b\u002Fdd2\u002F275\u002F92bdd227518182daf8250c3010fddfa9.png","title":"Гринатом","link":"https:\u002F\u002Fu.habr.com\u002Foavz7"},"title":"Симфония технологий","lang":"ru","startTime":"2024-12-03T10:00:00+03:00","finishTime":"2024-12-16T23:59:00+03:00","slides":[{"id":"story-908_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F79f\u002F9e0\u002F4b1\u002F79f9e04b1985cf18dc46d0e57d854bfb.PNG","button":null},{"id":"story-908_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F907\u002F67a\u002F83b\u002F90767a83b91dc0a19accde29d772ddf4.PNG","button":{"title":"Настраиваем","link":"https:\u002F\u002Fu.habr.com\u002Foavz7","colorType":"light"}},{"id":"story-908_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5d4\u002F92d\u002Fd22\u002F5d492dd22d5113dfd5f85fa16e76d6a2.PNG","button":null},{"id":"story-908_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F63b\u002F881\u002F1f4\u002F63b8811f4271d2deaa0319d2b6bc65df.PNG","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Foavz7","colorType":"light"}},{"id":"story-908_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F02b\u002F188\u002Fbc3\u002F02b188bc33baaf123e2cba68f59f8099.PNG","button":{"title":"Засинхронить","link":"https:\u002F\u002Fu.habr.com\u002Foavz7","colorType":"dark"}},{"id":"story-908_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3c4\u002Fcdf\u002F827\u002F3c4cdf8278aca01004bf323afdd734e0.jpg","button":null},{"id":"story-908_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3e8\u002Ff00\u002F14d\u002F3e8f0014d883a050e7bcd7b02af8e49c.PNG","button":{"title":"Присоединиться","link":"https:\u002F\u002Fu.habr.com\u002Foavz7","colorType":"light"}},{"id":"story-908_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F146\u002F868\u002F841\u002F14686884121c829e990f256f34af2137.PNG","button":null},{"id":"story-908_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff88\u002F368\u002F528\u002Ff883685282e1dc90ae6abe1bbff9dcc0.PNG","button":{"title":"Хочу так же","link":"https:\u002F\u002Fu.habr.com\u002Foavz7","colorType":"dark"}},{"id":"story-908_10","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3ce\u002F28f\u002Ff89\u002F3ce28ff89e02e2e58450b642c5608521.PNG","button":{"title":"Вступить","link":"https:\u002F\u002Fu.habr.com\u002Foavz7","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"notificationsLoading":false,"notificationsList":[],"notificationsPageCount":0,"pendingMarkNotificationsRead":[],"publicationsLoading":true,"publicationsList":[],"publicationsPageCount":0,"pendingDeletePublications":false,"pendingMarkPublicationsRead":false},"events":{"eventRefs":{"516":{"id":"516","titleHtml":"IT-конференция Merge Tatarstan 2025","descriptionHtml":"\u003Cp\u003EКрупнейшая региональная IT-конференция России собирает профессионалов со всей страны для нетворкинга, обмена опытом и поиска новых деловых контактов.\u003C\u002Fp\u003E\u003Cp\u003EMerge Tatarstan — это 7 тематических конференций на одной площадке, 2000 участников, более 170 спикеров-практиков, мастер-классы, воркшопы и BoF-сессии.\u003C\u002Fp\u003E\u003Cp\u003EК участию в конференции приглашаются разработчики, QA, тимлиды, Project\u002FProduct-менеджеры, маркетологи, аналитики, UI\u002FUX-дизайнеры, PR-специалисты, HR-менеджеры, владельцы бизнеса и начинающие специалисты.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0e9\u002F3a8\u002F3ec\u002F0e93a83ecea09f806d1df907ddb036a4.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_tatarstan","startDay":"2025-04-25","startTime":"09:00","finishDay":"2025-04-26","finishTime":"19:30","isOnline":false,"geo":["Казань"],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"10","titleHtml":"Маркетинг"},{"id":"16","titleHtml":"Другое"}],"tags":["Разработка","IT","PR","UI\u002FUX","бизнес","маркетинг","аналитика"],"metadata":null},"556":{"id":"556","titleHtml":"Международная конференция по AI\u002FML «AI Journey»","descriptionHtml":"\u003Cp\u003EМеждународная конференция по&nbsp;искусственному интеллекту (AI) и&nbsp;машинному обучению&nbsp;AI&nbsp;Journey&nbsp;(AIJ) пройдёт в&nbsp;Москве.&nbsp;Ключевая идея –&nbsp;возможность&nbsp;AI&nbsp;работать на&nbsp;благо человека. Речь пойдёт о&nbsp;том, как развитие AI-технологий не только влияет на повседневную жизнь людей, но и преображает мир профессий. Как использование AI поможет экспертам менять мир и строить новое устойчивое будущее, как технологии обогатят навыки и компетенции экологов, климатологов, врачей и педагогов.\u003C\u002Fp\u003E\u003Cp\u003EПрограмма AI&nbsp;Journey включает три тематических блока: наука, бизнес и&nbsp;общество. В них примут участие ведущие российские и&nbsp;международные исследователи, учёные, представители органов власти и&nbsp;бизнеса.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EМолодёжный трек AIJ Junior поможет всем, кто начинает свой путь в AI, погрузиться в мир искусственного интеллекта. На AIJ состоятся награждение победителей конкурса AI Challenge для юных исследователей данных и соревнования AIJ Contest для опытных AI-специалистов. Также будут подведены итоги открытого отбора научных статей — AIJ Science. Самые значимые работы войдут в научный журнал, выпускаемый совместно с РАН, автор лучшей получит вознаграждение.\u003C\u002Fp\u003E\u003Cp\u003EAIJ пройдёт в&nbsp;гибридном формате, онлайн-трансляция будет на&nbsp;сайте. Ключевые выступления с&nbsp;главной сцены будут переводиться на&nbsp;русский жестовый язык.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94b\u002F630\u002F102\u002F94b630102f2be1004ae59e84ea52419e.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_aijconf","startDay":"2024-12-11","startTime":"10:00","finishDay":"2024-12-13","isOnline":true,"geo":["Москва"],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"16","titleHtml":"Другое"}],"tags":["конференция","искусственный интеллект","ИИ","AI","AIJ"],"metadata":null},"560":{"id":"560","titleHtml":"Yandex DataLens Festival 2024","descriptionHtml":"\u003Cp\u003EYandex DataLens Festival — ежегодный фестиваль для аналитиков, разработчиков, менеджеров и всех, кто хочет эффективно анализировать и визуализировать данные.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВ этом году эксперты от Yandex Cloud, а также компании ППР и SQEEL расскажут:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EКак собрать отчёт с нуля в новом конструкторе.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак встраивать графики и дашборды в продукт, будь это CRM или корпоративный портал.&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак работать с BI-системой в любой инфраструктуре.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EУчастников ждут полезные материалы о продукте, видеовыступления спикеров, а также кейсы и сценарии применения DataLens для решения разных задач. Завершится мероприятие афтепати в офисе Яндекса в Москве.\u003C\u002Fp\u003E\u003Cp\u003EУчастие бесплатное, но необходима регистрация на сайте.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8b1\u002F7fd\u002F042\u002F8b17fd0425f4ae26bfc2422966f3d1c0.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_yandexcloudfest","startDay":"2024-12-02","finishDay":"2024-12-18","isOnline":true,"geo":["Москва"],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"8","titleHtml":"Менеджмент"},{"id":"12","titleHtml":"Аналитика"}],"tags":["BI","фестиваль для разработчиков","фестиваль для аналитиков","фестиваль для менеджеров","DataLens"],"metadata":null},"566":{"id":"566","titleHtml":"Вызов от Хекслета и Хабр Карьеры","descriptionHtml":"\u003Cp\u003EНа Хабр Карьере запустили последний спецпроект в этом году: новички смогут проверить свои навыки и бесплатно учиться на курсах Хекслета, а продвинутые специалисты — выбрать обучение, которое они давно хотели пройти, но все время откладывали.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВ программе — 12 тестовых, которые максимально приближены к реальным вакансиям, бесплатные курсы, чтобы справиться с каждым заданием, и прямой эфир с разбором ваших ошибок.\u003C\u002Fp\u003E\u003Cp\u003EСейчас и до 15 декабря для участников спецпроекта открыты вообще все курсы Хекслета.\u003C\u002Fp\u003E\u003Cp\u003E🔗 Нажимайте «Перейти на сайт», чтобы присоединиться. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe77\u002F90b\u002F4c4\u002Fe7790b4c4b1eac0ff361cada2d48721f.png","eventUrl":"https:\u002F\u002Fspecial.habr.com\u002F?utm_source=challenge_hexlet_calendar","startDay":"2024-12-02","finishDay":"2024-12-15","isOnline":true,"geo":[],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"12","titleHtml":"Аналитика"},{"id":"14","titleHtml":"Тестирование"}],"tags":["Карьера в IT","Спецпроект Хабр Карьеры","Python","Аналитика","Тестирование"],"metadata":null}},"eventIds":["566","560","556","516"],"pagesCount":1,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"4","titleHtml":"Администрирование"},{"id":"6","titleHtml":"Дизайн"},{"id":"8","titleHtml":"Менеджмент"},{"id":"10","titleHtml":"Маркетинг"},{"id":"12","titleHtml":"Аналитика"},{"id":"14","titleHtml":"Тестирование"},{"id":"16","titleHtml":"Другое"}],"cities":[{"id":"14","titleHtml":"Белград"},{"id":"58","titleHtml":"Бишкек"},{"id":"34","titleHtml":"Владивосток"},{"id":"16","titleHtml":"Владимир"},{"id":"52","titleHtml":"Волгоград"},{"id":"68","titleHtml":"Долгопрудный"},{"id":"10","titleHtml":"Екатеринбург"},{"id":"42","titleHtml":"Ижевск"},{"id":"6","titleHtml":"Иннополис"},{"id":"66","titleHtml":"Иркутск"},{"id":"46","titleHtml":"Казань"},{"id":"30","titleHtml":"Калининград"},{"id":"22","titleHtml":"Калуга"},{"id":"17","titleHtml":"Краснодар"},{"id":"38","titleHtml":"Краснорск"},{"id":"48","titleHtml":"Курск"},{"id":"19","titleHtml":"Минск"},{"id":"2","titleHtml":"Москва"},{"id":"56","titleHtml":"Мурманск"},{"id":"8","titleHtml":"Нижний Новгород"},{"id":"12","titleHtml":"Новосибирск"},{"id":"28","titleHtml":"Новосибриск"},{"id":"24","titleHtml":"Переславль-Залесский"},{"id":"32","titleHtml":"Пермь"},{"id":"44","titleHtml":"Петрозаводск"},{"id":"4","titleHtml":"Санкт-Петербург"},{"id":"64","titleHtml":"Саратов"},{"id":"60","titleHtml":"Сочи"},{"id":"26","titleHtml":"Ставрополь"},{"id":"40","titleHtml":"Томск"},{"id":"50","titleHtml":"Тюмень"},{"id":"62","titleHtml":"Ульяновск"},{"id":"21","titleHtml":"Ульяновская область"},{"id":"54","titleHtml":"Уфа"},{"id":"36","titleHtml":"Чита"}],"actualEvents":[{"id":"560","titleHtml":"Yandex DataLens Festival 2024","descriptionHtml":"\u003Cp\u003EYandex DataLens Festival — ежегодный фестиваль для аналитиков, разработчиков, менеджеров и всех, кто хочет эффективно анализировать и визуализировать данные.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВ этом году эксперты от Yandex Cloud, а также компании ППР и SQEEL расскажут:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EКак собрать отчёт с нуля в новом конструкторе.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак встраивать графики и дашборды в продукт, будь это CRM или корпоративный портал.&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак работать с BI-системой в любой инфраструктуре.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EУчастников ждут полезные материалы о продукте, видеовыступления спикеров, а также кейсы и сценарии применения DataLens для решения разных задач. Завершится мероприятие афтепати в офисе Яндекса в Москве.\u003C\u002Fp\u003E\u003Cp\u003EУчастие бесплатное, но необходима регистрация на сайте.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8b1\u002F7fd\u002F042\u002F8b17fd0425f4ae26bfc2422966f3d1c0.jpeg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_yandexcloudfest","startDay":"2024-12-02","finishDay":"2024-12-18","isOnline":true,"geo":["Москва"],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"8","titleHtml":"Менеджмент"},{"id":"12","titleHtml":"Аналитика"}],"tags":["BI","фестиваль для разработчиков","фестиваль для аналитиков","фестиваль для менеджеров","DataLens"],"metadata":null},{"id":"566","titleHtml":"Вызов от Хекслета и Хабр Карьеры","descriptionHtml":"\u003Cp\u003EНа Хабр Карьере запустили последний спецпроект в этом году: новички смогут проверить свои навыки и бесплатно учиться на курсах Хекслета, а продвинутые специалисты — выбрать обучение, которое они давно хотели пройти, но все время откладывали.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВ программе — 12 тестовых, которые максимально приближены к реальным вакансиям, бесплатные курсы, чтобы справиться с каждым заданием, и прямой эфир с разбором ваших ошибок.\u003C\u002Fp\u003E\u003Cp\u003EСейчас и до 15 декабря для участников спецпроекта открыты вообще все курсы Хекслета.\u003C\u002Fp\u003E\u003Cp\u003E🔗 Нажимайте «Перейти на сайт», чтобы присоединиться. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe77\u002F90b\u002F4c4\u002Fe7790b4c4b1eac0ff361cada2d48721f.png","eventUrl":"https:\u002F\u002Fspecial.habr.com\u002F?utm_source=challenge_hexlet_calendar","startDay":"2024-12-02","finishDay":"2024-12-15","isOnline":true,"geo":[],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"12","titleHtml":"Аналитика"},{"id":"14","titleHtml":"Тестирование"}],"tags":["Карьера в IT","Спецпроект Хабр Карьеры","Python","Аналитика","Тестирование"],"metadata":null},{"id":"556","titleHtml":"Международная конференция по AI\u002FML «AI Journey»","descriptionHtml":"\u003Cp\u003EМеждународная конференция по&nbsp;искусственному интеллекту (AI) и&nbsp;машинному обучению&nbsp;AI&nbsp;Journey&nbsp;(AIJ) пройдёт в&nbsp;Москве.&nbsp;Ключевая идея –&nbsp;возможность&nbsp;AI&nbsp;работать на&nbsp;благо человека. Речь пойдёт о&nbsp;том, как развитие AI-технологий не только влияет на повседневную жизнь людей, но и преображает мир профессий. Как использование AI поможет экспертам менять мир и строить новое устойчивое будущее, как технологии обогатят навыки и компетенции экологов, климатологов, врачей и педагогов.\u003C\u002Fp\u003E\u003Cp\u003EПрограмма AI&nbsp;Journey включает три тематических блока: наука, бизнес и&nbsp;общество. В них примут участие ведущие российские и&nbsp;международные исследователи, учёные, представители органов власти и&nbsp;бизнеса.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EМолодёжный трек AIJ Junior поможет всем, кто начинает свой путь в AI, погрузиться в мир искусственного интеллекта. На AIJ состоятся награждение победителей конкурса AI Challenge для юных исследователей данных и соревнования AIJ Contest для опытных AI-специалистов. Также будут подведены итоги открытого отбора научных статей — AIJ Science. Самые значимые работы войдут в научный журнал, выпускаемый совместно с РАН, автор лучшей получит вознаграждение.\u003C\u002Fp\u003E\u003Cp\u003EAIJ пройдёт в&nbsp;гибридном формате, онлайн-трансляция будет на&nbsp;сайте. Ключевые выступления с&nbsp;главной сцены будут переводиться на&nbsp;русский жестовый язык.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F94b\u002F630\u002F102\u002F94b630102f2be1004ae59e84ea52419e.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_aijconf","startDay":"2024-12-11","startTime":"10:00","finishDay":"2024-12-13","isOnline":true,"geo":["Москва"],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"16","titleHtml":"Другое"}],"tags":["конференция","искусственный интеллект","ИИ","AI","AIJ"],"metadata":null},{"id":"516","titleHtml":"IT-конференция Merge Tatarstan 2025","descriptionHtml":"\u003Cp\u003EКрупнейшая региональная IT-конференция России собирает профессионалов со всей страны для нетворкинга, обмена опытом и поиска новых деловых контактов.\u003C\u002Fp\u003E\u003Cp\u003EMerge Tatarstan — это 7 тематических конференций на одной площадке, 2000 участников, более 170 спикеров-практиков, мастер-классы, воркшопы и BoF-сессии.\u003C\u002Fp\u003E\u003Cp\u003EК участию в конференции приглашаются разработчики, QA, тимлиды, Project\u002FProduct-менеджеры, маркетологи, аналитики, UI\u002FUX-дизайнеры, PR-специалисты, HR-менеджеры, владельцы бизнеса и начинающие специалисты.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0e9\u002F3a8\u002F3ec\u002F0e93a83ecea09f806d1df907ddb036a4.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_tatarstan","startDay":"2025-04-25","startTime":"09:00","finishDay":"2025-04-26","finishTime":"19:30","isOnline":false,"geo":["Казань"],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"10","titleHtml":"Маркетинг"},{"id":"16","titleHtml":"Другое"}],"tags":["Разработка","IT","PR","UI\u002FUX","бизнес","маркетинг","аналитика"],"metadata":null}],"currentEvent":{"id":"566","titleHtml":"Вызов от Хекслета и Хабр Карьеры","descriptionHtml":"\u003Cp\u003EНа Хабр Карьере запустили последний спецпроект в этом году: новички смогут проверить свои навыки и бесплатно учиться на курсах Хекслета, а продвинутые специалисты — выбрать обучение, которое они давно хотели пройти, но все время откладывали.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВ программе — 12 тестовых, которые максимально приближены к реальным вакансиям, бесплатные курсы, чтобы справиться с каждым заданием, и прямой эфир с разбором ваших ошибок.\u003C\u002Fp\u003E\u003Cp\u003EСейчас и до 15 декабря для участников спецпроекта открыты вообще все курсы Хекслета.\u003C\u002Fp\u003E\u003Cp\u003E🔗 Нажимайте «Перейти на сайт», чтобы присоединиться. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe77\u002F90b\u002F4c4\u002Fe7790b4c4b1eac0ff361cada2d48721f.png","eventUrl":"https:\u002F\u002Fspecial.habr.com\u002F?utm_source=challenge_hexlet_calendar","startDay":"2024-12-02","finishDay":"2024-12-15","isOnline":true,"geo":[],"isArchive":false,"categories":[{"id":"2","titleHtml":"Разработка"},{"id":"12","titleHtml":"Аналитика"},{"id":"14","titleHtml":"Тестирование"}],"tags":["Карьера в IT","Спецпроект Хабр Карьеры","Python","Аналитика","Тестирование"],"metadata":{"description":"На Хабр Карьере запустили последний спецпроект в этом году: новички смогут проверить свои навыки и бесплатно учиться на курсах Хекслета, а продвинутые специалисты — выбрать обучение, которое они давно...","keywords":"карьера в it, спецпроект хабр карьеры, python, аналитика, тестирование"}},"eventsFilter":{"city":"all","timeStarted":null,"timeEnded":null,"pageNum":1}},"wysiwyg":{"WYSIWYGRulesRefs":null}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="https://assets.habr.com/habr-web/js/chunk-vendors.5f7b98a7.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.ba2c25ec.js" defer></script></div>
    <div id="overlays"><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--><!----><!--teleport anchor--></div>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S28W1WC23F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
    </body>

    </html>
